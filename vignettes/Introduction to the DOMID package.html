<!DOCTYPE html>
<!-- saved from url=(0097)file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">


<meta name="generator" content="pandoc">
<meta http-equiv="X-UA-Compatible" content="IE=EDGE">

<meta name="viewport" content="width=device-width, initial-scale=1">



<title>Introduction to the DOMID package</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




<script type="text/javascript" src="./Introduction to the DOMID package_files/MathJax.js.download"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://mathjax.rstudio.com/latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.2') format('woff'), url('https://mathjax.rstudio.com/latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.2') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('https://mathjax.rstudio.com/latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.2') format('woff'), url('https://mathjax.rstudio.com/latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.2') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('https://mathjax.rstudio.com/latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.2') format('woff'), url('https://mathjax.rstudio.com/latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.2') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('https://mathjax.rstudio.com/latest/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.2') format('woff'), url('https://mathjax.rstudio.com/latest/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.2') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('https://mathjax.rstudio.com/latest/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.2') format('woff'), url('https://mathjax.rstudio.com/latest/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.2') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://mathjax.rstudio.com/latest/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.2') format('woff'), url('https://mathjax.rstudio.com/latest/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.2') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://mathjax.rstudio.com/latest/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.2') format('woff'), url('https://mathjax.rstudio.com/latest/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.2') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://mathjax.rstudio.com/latest/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.2') format('woff'), url('https://mathjax.rstudio.com/latest/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.2') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://mathjax.rstudio.com/latest/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.2') format('woff'), url('https://mathjax.rstudio.com/latest/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.2') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">@font-face {font-family: MathJax_Math-bold-italic; src: url('https://mathjax.rstudio.com/latest/fonts/HTML-CSS/TeX/woff/MathJax_Math-BoldItalic.woff?V=2.7.2') format('woff'), url('https://mathjax.rstudio.com/latest/fonts/HTML-CSS/TeX/otf/MathJax_Math-BoldItalic.otf?V=2.7.2') format('opentype')}
</style><style type="text/css">@font-face {font-family: MathJax_AMS; src: url('https://mathjax.rstudio.com/latest/fonts/HTML-CSS/TeX/woff/MathJax_AMS-Regular.woff?V=2.7.2') format('woff'), url('https://mathjax.rstudio.com/latest/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf?V=2.7.2') format('opentype')}
</style></head>

<body><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>




<h1 class="title toc-ignore">Introduction to the DOMID package</h1>



<div id="domid-package---overview" class="section level2">
<h2><code>DOMID</code> package - Overview</h2>
<p>The <code>DOMID</code> (Detecting Outliers in MIxed-type Data) R
package includes functions that can be used for detecting outliers in
data sets consisting of mixed-type data (i.e.&nbsp;both continuous and
discrete variables). Some of the capabilities of the package
include:</p>
<ul>
<li>Generating artificial data sets of mixed-type data, including some
marginal outliers in either the discrete or the continuous domain (or
both), as well as joint outliers.</li>
<li>Calculating scores of outlyingness for both the continuous and the
discrete features of a data set.</li>
<li>Detecting the marginal outliers in a mixed data set, when given
scores of outlyingness for discrete &amp; continuous features.</li>
<li>Finding associations among discrete variables and sets of continuous
features.</li>
<li>Detecting joint outliers for a given association among a discrete
and a set of continuous variables.</li>
</ul>
<p>Below, we present some of the functions included in
<code>DOMID</code>, so that the user can familiarise themselves with the
package.</p>
</div>
<div id="artificial-data-set-generation---gen_marg_joint_data" class="section level2">
<h2>Artificial data set generation -
<code>gen_marg_joint_data</code></h2>
<p>Suppose that we are interested in generating an artificial data set
consisting of both discrete and continuous variables. We want this data
set to include some outlying observations in both the discrete and the
continuous domains (i.e.&nbsp;marginal outliers), as well as a few joint
outliers. More precisely, we generate an artificial data set with 1000
observations, 5 discrete and 5 continuous variables. We set the second
discrete variable to have 4 levels and the rest to have 3 discrete
levels instead. The proportion of outliers in the data set is 5%, out of
which 20% are joint outliers (thus the remaining 80% of outliers will be
marginal outliers).</p>
<p>In order to define joint outliers, we need to impose at least one
association among a discrete and a set of continuous variables. We set
the first 2 discrete variables to be associated with the first 2
continuous variables each. The association type is set to
<code>linear</code> for both existing associations. As a result,
projecting the data set in the space spanned by the first 2 continuous
variables and colouring each observation according to the level of the
first or the second discrete variable should reveal a linear pattern. We
generate this data set using a seed number of 1 for reproducibility,
store it as <code>dt</code> and we then display its structure.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb1-1" tabindex="-1"></a><span class="fu">library</span>(DOMID)</span>
<span id="cb1-2"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb1-2" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">gen_marg_joint_data</span>(<span class="at">n_obs =</span> <span class="dv">1000</span>, <span class="at">n_disc =</span> <span class="dv">5</span>, <span class="at">n_cont =</span> <span class="dv">5</span>,</span>
<span id="cb1-3"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb1-3" tabindex="-1"></a>                          <span class="at">n_lvls =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>), <span class="at">p_outs =</span> <span class="fl">0.05</span>, <span class="at">jp_outs =</span> <span class="fl">0.2</span>,</span>
<span id="cb1-4"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb1-4" tabindex="-1"></a>                          <span class="at">assoc_target =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">assoc_vars =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)),</span>
<span id="cb1-5"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb1-5" tabindex="-1"></a>                          <span class="at">assoc_type =</span> <span class="st">'linear'</span>, <span class="at">seed_num =</span> <span class="dv">1</span>)</span>
<span id="cb1-6"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb1-6" tabindex="-1"></a><span class="co">#&gt; Marginal outliers generated.</span></span>
<span id="cb1-7"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb1-7" tabindex="-1"></a><span class="co">#&gt; Joint outliers generated.</span></span>
<span id="cb1-8"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb1-8" tabindex="-1"></a><span class="co">#&gt; Data frame generated.</span></span>
<span id="cb1-9"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb1-9" tabindex="-1"></a><span class="fu">str</span>(dt)</span>
<span id="cb1-10"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb1-10" tabindex="-1"></a><span class="co">#&gt; 'data.frame':    1000 obs. of  11 variables:</span></span>
<span id="cb1-11"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb1-11" tabindex="-1"></a><span class="co">#&gt;  $ V1 : Factor w/ 4 levels "1","2","3","4": 1 3 2 2 3 2 1 2 3 3 ...</span></span>
<span id="cb1-12"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb1-12" tabindex="-1"></a><span class="co">#&gt;  $ V2 : Factor w/ 5 levels "1","2","3","4",..: 1 3 2 2 4 2 2 3 3 3 ...</span></span>
<span id="cb1-13"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb1-13" tabindex="-1"></a><span class="co">#&gt;  $ V3 : Factor w/ 4 levels "1","2","3","4": 3 1 1 2 3 1 2 2 3 2 ...</span></span>
<span id="cb1-14"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb1-14" tabindex="-1"></a><span class="co">#&gt;  $ V4 : Factor w/ 4 levels "1","2","3","4": 3 1 2 2 2 3 2 2 1 2 ...</span></span>
<span id="cb1-15"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb1-15" tabindex="-1"></a><span class="co">#&gt;  $ V5 : Factor w/ 4 levels "1","2","3","4": 2 1 1 3 1 3 2 2 1 3 ...</span></span>
<span id="cb1-16"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb1-16" tabindex="-1"></a><span class="co">#&gt;  $ V6 : num  -3.16458 1.14932 -0.2301 0.1009 0.00752 ...</span></span>
<span id="cb1-17"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb1-17" tabindex="-1"></a><span class="co">#&gt;  $ V7 : num  0.5 -0.283 0.604 0.992 -2.69 ...</span></span>
<span id="cb1-18"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb1-18" tabindex="-1"></a><span class="co">#&gt;  $ V8 : num  -0.678 2.361 -1.143 -0.106 -0.968 ...</span></span>
<span id="cb1-19"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb1-19" tabindex="-1"></a><span class="co">#&gt;  $ V9 : num  2.465 -0.5 -1.036 -0.724 -0.294 ...</span></span>
<span id="cb1-20"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb1-20" tabindex="-1"></a><span class="co">#&gt;  $ V10: num  0.187 -1.027 -1.145 2.166 -1.094 ...</span></span>
<span id="cb1-21"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb1-21" tabindex="-1"></a><span class="co">#&gt;  $ V11: num  0 0 0 0 0 0 0 0 0 0 ...</span></span></code></pre></div>
<p>As we can see, the data frame that has been generated includes 1000
observations. The first 5 variables are discrete with the number of
levels we indicated plus an additional level; this level is introduced
due to the generation of marginal outliers in the data set. In this
case, the outliers that were generated in the discrete space will take
levels that appear in very low frequencies and which are therefore
indicative of an anomalous behaviour. Then, we have 5 continuous
variables and finally an additional variable which is generated
automatically by the function and which is a label of outlyingness. More
precisely, a value of 0 indicates that the observation is not an
outlier, a value of 1 indicates that the observation is a single
marginal outlier (i.e.&nbsp;an outlier in either just the discrete or just
the continuous domain), a value of 2 refers to the observation being a
combined marginal outlier (i.e.&nbsp;an observation in both the discrete and
the continuous spaces) and finally a value of 3 is assigned to joint
outliers. Finally, in order to investigate whether the associations we
imposed are indeed valid, we plot the first two continuous variables
with points coloured according to the first and the second discrete
variable levels. We make sure to discard any marginal outliers, so that
the associations can be observed more easily.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb2-1" tabindex="-1"></a><span class="fu">require</span>(ggplot2)</span>
<span id="cb2-2"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb2-2" tabindex="-1"></a><span class="co">#&gt; Loading required package: ggplot2</span></span>
<span id="cb2-3"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb2-3" tabindex="-1"></a>assoc1_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dt[<span class="fu">which</span>(dt<span class="sc">$</span>V11 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>)), ], <span class="fu">aes</span>(<span class="at">x =</span> V6, <span class="at">y =</span> V7)) <span class="sc">+</span></span>
<span id="cb2-4"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb2-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col=</span>V1)) <span class="sc">+</span> </span>
<span id="cb2-5"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb2-5" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">'Continuous Variable 1'</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">'Continuous Variable 2'</span>) <span class="sc">+</span> </span>
<span id="cb2-6"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb2-6" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">col=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Discrete</span><span class="sc">\n</span><span class="st">Variable 1</span><span class="sc">\n</span><span class="st">Level"</span>)) <span class="sc">+</span></span>
<span id="cb2-7"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb2-7" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb2-8"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb2-8" tabindex="-1"></a>assoc2_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dt[<span class="fu">which</span>(dt<span class="sc">$</span>V11 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>)), ], <span class="fu">aes</span>(<span class="at">x =</span> V6, <span class="at">y =</span> V7)) <span class="sc">+</span></span>
<span id="cb2-9"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb2-9" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col=</span>V2)) <span class="sc">+</span> </span>
<span id="cb2-10"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb2-10" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">'Continuous Variable 1'</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">'Continuous Variable 2'</span>) <span class="sc">+</span> </span>
<span id="cb2-11"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb2-11" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">col=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Discrete</span><span class="sc">\n</span><span class="st">Variable 2</span><span class="sc">\n</span><span class="st">Level"</span>)) <span class="sc">+</span></span>
<span id="cb2-12"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb2-12" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb2-13"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb2-13" tabindex="-1"></a>assoc1_plot</span></code></pre></div>
<p><img src="data:image/png;base64,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"><!-- --></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb3-1" tabindex="-1"></a>assoc2_plot</span></code></pre></div>
<p><img src="data:image/png;base64,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"><!-- --></p>
<p>Indeed, we see that the associations have been generated correctly.
As you may observe, there exist a few points which do not seem to agree
with with the relationships that we imposed; these observations are the
joint outliers that were generated.</p>
</div>
<div id="scores-of-outlyingness---disc_scores-cont_scores" class="section level2">
<h2>Scores of outlyingness - <code>disc_scores</code> &amp;
<code>cont_scores</code></h2>
<p>In order to be able to detect marginal outliers (i.e.&nbsp;outliers in
either the discrete or the continuous space), we need to compute scores
of outlyingness for the discrete and the continuous features of each
observation. The function <code>disc_scores</code> takes as input a data
set and the indices of the columns corresponding to the discrete
variables. Notice that the discrete features must be of class
<code>factor</code>; this is something that we do not need to worry
about, since the function <code>gen_marg_joint_data</code> returns
discrete variable columns of the aforementioned class. The output of
<code>disc_scores</code> is a list of 3 elements. The first element is
the parameter <code>MAXLEN</code> that is used for computing discrete
scores. The second element in the list is a data frame with the discrete
scores of outlyingness. Finally, the last element in the output list is
a matrix of dimensions <code>nrow(data) x length(disc_cols)</code>,
including the contribution of each discrete feature to the discrete
score of outlyingness of each observation.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb4-1" tabindex="-1"></a>discrete_scores <span class="ot">&lt;-</span> <span class="fu">disc_scores</span>(<span class="at">data =</span> dt, <span class="at">disc_cols =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>))</span>
<span id="cb4-2"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb4-2" tabindex="-1"></a><span class="co">#&gt; Power set object created. </span></span>
<span id="cb4-3"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb4-3" tabindex="-1"></a><span class="co">#&gt; Pre-processing done. </span></span>
<span id="cb4-4"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb4-4" tabindex="-1"></a><span class="co">#&gt; Sequences list created. </span></span>
<span id="cb4-5"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb4-5" tabindex="-1"></a><span class="co">#&gt; List with counts and frequencies created successfully. </span></span>
<span id="cb4-6"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb4-6" tabindex="-1"></a><span class="co">#&gt; Outlyingness scores for discrete variables calculated.</span></span>
<span id="cb4-7"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb4-7" tabindex="-1"></a><span class="co"># MAXLEN</span></span>
<span id="cb4-8"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb4-8" tabindex="-1"></a>discrete_scores[[<span class="dv">1</span>]]</span>
<span id="cb4-9"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb4-9" tabindex="-1"></a><span class="co">#&gt; [1] 2</span></span>
<span id="cb4-10"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb4-10" tabindex="-1"></a><span class="co"># Discrete scores for observations 61-70</span></span>
<span id="cb4-11"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb4-11" tabindex="-1"></a>discrete_scores[[<span class="dv">2</span>]][<span class="fu">c</span>(<span class="dv">61</span><span class="sc">:</span><span class="dv">70</span>), ]</span>
<span id="cb4-12"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb4-12" tabindex="-1"></a><span class="co">#&gt;    Observation     Score</span></span>
<span id="cb4-13"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb4-13" tabindex="-1"></a><span class="co">#&gt; 61          61 0.0000000</span></span>
<span id="cb4-14"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb4-14" tabindex="-1"></a><span class="co">#&gt; 62          62 0.0000000</span></span>
<span id="cb4-15"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb4-15" tabindex="-1"></a><span class="co">#&gt; 63          63 0.0000000</span></span>
<span id="cb4-16"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb4-16" tabindex="-1"></a><span class="co">#&gt; 64          64 0.0000000</span></span>
<span id="cb4-17"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb4-17" tabindex="-1"></a><span class="co">#&gt; 65          65 0.0000000</span></span>
<span id="cb4-18"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb4-18" tabindex="-1"></a><span class="co">#&gt; 66          66 0.0000000</span></span>
<span id="cb4-19"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb4-19" tabindex="-1"></a><span class="co">#&gt; 67          67 0.1666667</span></span>
<span id="cb4-20"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb4-20" tabindex="-1"></a><span class="co">#&gt; 68          68 0.0000000</span></span>
<span id="cb4-21"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb4-21" tabindex="-1"></a><span class="co">#&gt; 69          69 0.0000000</span></span>
<span id="cb4-22"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb4-22" tabindex="-1"></a><span class="co">#&gt; 70          70 0.0000000</span></span>
<span id="cb4-23"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb4-23" tabindex="-1"></a><span class="co"># Contributions of discrete features for observations 61-70</span></span>
<span id="cb4-24"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb4-24" tabindex="-1"></a>discrete_scores[[<span class="dv">3</span>]][<span class="fu">c</span>(<span class="dv">61</span><span class="sc">:</span><span class="dv">70</span>), ]</span>
<span id="cb4-25"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb4-25" tabindex="-1"></a><span class="co">#&gt;    V1 V2 V3        V4 V5</span></span>
<span id="cb4-26"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb4-26" tabindex="-1"></a><span class="co">#&gt; 61  0  0  0 0.0000000  0</span></span>
<span id="cb4-27"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb4-27" tabindex="-1"></a><span class="co">#&gt; 62  0  0  0 0.0000000  0</span></span>
<span id="cb4-28"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb4-28" tabindex="-1"></a><span class="co">#&gt; 63  0  0  0 0.0000000  0</span></span>
<span id="cb4-29"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb4-29" tabindex="-1"></a><span class="co">#&gt; 64  0  0  0 0.0000000  0</span></span>
<span id="cb4-30"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb4-30" tabindex="-1"></a><span class="co">#&gt; 65  0  0  0 0.0000000  0</span></span>
<span id="cb4-31"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb4-31" tabindex="-1"></a><span class="co">#&gt; 66  0  0  0 0.0000000  0</span></span>
<span id="cb4-32"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb4-32" tabindex="-1"></a><span class="co">#&gt; 67  0  0  0 0.1666667  0</span></span>
<span id="cb4-33"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb4-33" tabindex="-1"></a><span class="co">#&gt; 68  0  0  0 0.0000000  0</span></span>
<span id="cb4-34"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb4-34" tabindex="-1"></a><span class="co">#&gt; 69  0  0  0 0.0000000  0</span></span>
<span id="cb4-35"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb4-35" tabindex="-1"></a><span class="co">#&gt; 70  0  0  0 0.0000000  0</span></span></code></pre></div>
<p>Computing the continuous scores of outlyingness is easily done using
the <code>cont_scores</code> function. The function makes use of the
Extended Isolation Forest algorithm from the <code>isotree</code>
package. The default hyperparameter values for the Extended Isolation
Forest algorithm are <code>sample_size = 256</code>,
<code>ntrees = 500</code>, <code>max_depth = 100</code> and finally
<code>ndim = 0</code>, corresponding to
<code>ndim = length(cont_cols)</code>. The output is a data frame with
the continuous score for each observation, just like the 2nd element of
the list that the <code>disc_scores</code> function returns.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb5-1" tabindex="-1"></a>continuous_scores <span class="ot">&lt;-</span> <span class="fu">cont_scores</span>(<span class="at">data =</span> dt, <span class="at">cont_cols =</span> <span class="fu">c</span>(<span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>), <span class="at">sample_size =</span> <span class="dv">256</span>,</span>
<span id="cb5-2"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb5-2" tabindex="-1"></a>                                 <span class="at">ntrees =</span> <span class="dv">500</span>, <span class="at">ndim =</span> <span class="dv">0</span>, <span class="at">max_depth =</span> <span class="dv">100</span>, <span class="at">seed_num =</span> <span class="dv">1</span>)</span>
<span id="cb5-3"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb5-3" tabindex="-1"></a><span class="co">#&gt; Outlyingness scores for continuous variables calculated.</span></span>
<span id="cb5-4"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb5-4" tabindex="-1"></a><span class="co"># Continuous scores for first 10 observations</span></span>
<span id="cb5-5"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb5-5" tabindex="-1"></a>continuous_scores[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>), ]</span>
<span id="cb5-6"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb5-6" tabindex="-1"></a><span class="co">#&gt;    Observation     Score</span></span>
<span id="cb5-7"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb5-7" tabindex="-1"></a><span class="co">#&gt; 1            1 0.4245878</span></span>
<span id="cb5-8"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb5-8" tabindex="-1"></a><span class="co">#&gt; 2            2 0.3949470</span></span>
<span id="cb5-9"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb5-9" tabindex="-1"></a><span class="co">#&gt; 3            3 0.3269872</span></span>
<span id="cb5-10"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb5-10" tabindex="-1"></a><span class="co">#&gt; 4            4 0.3361358</span></span>
<span id="cb5-11"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb5-11" tabindex="-1"></a><span class="co">#&gt; 5            5 0.3475090</span></span>
<span id="cb5-12"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb5-12" tabindex="-1"></a><span class="co">#&gt; 6            6 0.3903265</span></span>
<span id="cb5-13"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb5-13" tabindex="-1"></a><span class="co">#&gt; 7            7 0.3401608</span></span>
<span id="cb5-14"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb5-14" tabindex="-1"></a><span class="co">#&gt; 8            8 0.3052729</span></span>
<span id="cb5-15"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb5-15" tabindex="-1"></a><span class="co">#&gt; 9            9 0.3753116</span></span>
<span id="cb5-16"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb5-16" tabindex="-1"></a><span class="co">#&gt; 10          10 0.3596560</span></span></code></pre></div>
<p>We can finally generate a score profile plot to see if the scores
computed agree with whether each observation is an outlier or not.
Indeed, we can see that marginal outliers appear to have higher discrete
and continuous scores than inliers (i.e.&nbsp;non-outliers) and joint
outliers, which are by definition not expected to have large scores of
outlyingness.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb6-1" tabindex="-1"></a><span class="co"># Add everything in a data frame</span></span>
<span id="cb6-2"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb6-2" tabindex="-1"></a>score_profile_dt <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">'Type'</span> <span class="ot">=</span> <span class="fu">as.factor</span>(dt[,<span class="dv">11</span>]),</span>
<span id="cb6-3"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb6-3" tabindex="-1"></a>                               <span class="st">'Discrete_Score'</span> <span class="ot">=</span> discrete_scores[[<span class="dv">2</span>]][, <span class="dv">2</span>],</span>
<span id="cb6-4"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb6-4" tabindex="-1"></a>                               <span class="st">'Continuous_Score'</span> <span class="ot">=</span> continuous_scores[, <span class="dv">2</span>])</span>
<span id="cb6-5"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb6-5" tabindex="-1"></a><span class="co"># Score profile plot</span></span>
<span id="cb6-6"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb6-6" tabindex="-1"></a>score_profile_dt <span class="ot">&lt;-</span> score_profile_dt[<span class="fu">order</span>(score_profile_dt<span class="sc">$</span>Type), ]</span>
<span id="cb6-7"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb6-7" tabindex="-1"></a><span class="fu">ggplot</span>(score_profile_dt, <span class="fu">aes</span>(<span class="at">x =</span> Discrete_Score, <span class="at">y=</span>Continuous_Score)) <span class="sc">+</span></span>
<span id="cb6-8"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb6-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> Type)) <span class="sc">+</span> </span>
<span id="cb6-9"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb6-9" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">'Discrete Score'</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">'Continuous Score'</span>) <span class="sc">+</span></span>
<span id="cb6-10"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb6-10" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Score profile plot for generated data set"</span>) <span class="sc">+</span></span>
<span id="cb6-11"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb6-11" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">'Inlier'</span>, <span class="st">'Single Marginal</span><span class="sc">\n</span><span class="st">Outlier'</span>,</span>
<span id="cb6-12"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb6-12" tabindex="-1"></a>                                  <span class="st">'Combined Marginal</span><span class="sc">\n</span><span class="st">Outlier'</span>, <span class="st">'Joint Outlier'</span>),</span>
<span id="cb6-13"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb6-13" tabindex="-1"></a>                     <span class="at">palette =</span> <span class="st">"Paired"</span>) <span class="sc">+</span> </span>
<span id="cb6-14"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb6-14" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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"><!-- --></p>
</div>
<div id="detecting-marginal-outliers---marg_outs_scores-marg_outs" class="section level2">
<h2>Detecting marginal outliers - <code>marg_outs_scores</code> &amp;
<code>marg_outs</code></h2>
<p>In order to detect the marginal outliers in a data frame, we need to
make use of the discrete and the continuous scores of outlyingness. The
function <code>marg_outs_scores</code> uses the scores (both discrete
&amp; continuous), as well as the matrix of contributions and detects
the observations with scores higher than the majority of data points,
which are therefore much more likely outlying in either space. The
output is a list consisting of 3 vectors, the first 2 corresponding to
the row indices of outlying observations in just the discrete or just
the continuous space and the 3rd corresponding to the combined marginal
outliers (i.e.&nbsp;observations outlying in both domains). We use this
function on our data frame to see if the observations flagged as
marginal outliers are indeed so.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb7-1" tabindex="-1"></a>marginal_outliers <span class="ot">&lt;-</span> <span class="fu">marg_outs_scores</span>(<span class="at">data =</span> dt,</span>
<span id="cb7-2"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb7-2" tabindex="-1"></a>                                      <span class="at">disc_cols =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>),</span>
<span id="cb7-3"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb7-3" tabindex="-1"></a>                                      <span class="at">outscorediscdf =</span> discrete_scores[[<span class="dv">2</span>]],</span>
<span id="cb7-4"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb7-4" tabindex="-1"></a>                                      <span class="at">outscorecontdf =</span> continuous_scores,</span>
<span id="cb7-5"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb7-5" tabindex="-1"></a>                                      <span class="at">outscorediscdfcells =</span> discrete_scores[[<span class="dv">3</span>]])</span>
<span id="cb7-6"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb7-6" tabindex="-1"></a><span class="co">#&gt; Marginal outliers detected.</span></span>
<span id="cb7-7"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb7-7" tabindex="-1"></a><span class="fu">table</span>(dt[<span class="fu">unique</span>(<span class="fu">unlist</span>(marginal_outliers)), <span class="dv">11</span>])</span>
<span id="cb7-8"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb7-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-9"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb7-9" tabindex="-1"></a><span class="co">#&gt;  1  2 </span></span>
<span id="cb7-10"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb7-10" tabindex="-1"></a><span class="co">#&gt; 38  2</span></span></code></pre></div>
<p>Indeed, our data set included 38 single marginal and 2 combined
marginal outliers, meaning that the function has managed to detect
these, while not erroneously flagging any inliers or joint outliers. An
alternative option is to use the <code>marg_outs</code> function
instead. This function only takes as input variables the data frame, the
indices of the discrete variable columns and the indices of the
continuous variable columns. It returns the same output as
<code>marg_outs_scores</code>. In fact, <code>marg_outs</code> uses
<code>marg_outs_scores</code>; their difference is that the former does
not require inputting discrete or continuous scores of outlyingness, as
these are calculated automatically using <code>disc_scores</code> and
<code>cont_scores</code>. Using <code>marg_outs_scores</code> offers
additional flexibility; for example, the user can set the hyperparameter
values for the Extended Isolation Forest algorithm used in
<code>cont_scores</code>, whereas <code>marg_outs</code> will use the
aforementioned function with its deafult hyperparameter values. In this
case, all hyperparameters involved in the calculation of the discrete
and the continuous scores were set equal to their default values, so we
expect <code>marg_outs</code> to return identical results to
<code>marg_outs_scores</code>, as we show below.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb8-1" tabindex="-1"></a>marginal_outliers_2 <span class="ot">&lt;-</span> <span class="fu">marg_outs</span>(<span class="at">data =</span> dt,</span>
<span id="cb8-2"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb8-2" tabindex="-1"></a>                                 <span class="at">disc_cols =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>),</span>
<span id="cb8-3"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb8-3" tabindex="-1"></a>                                 <span class="at">cont_cols =</span> <span class="fu">c</span>(<span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>))</span>
<span id="cb8-4"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb8-4" tabindex="-1"></a><span class="co">#&gt; Power set object created. </span></span>
<span id="cb8-5"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb8-5" tabindex="-1"></a><span class="co">#&gt; Pre-processing done. </span></span>
<span id="cb8-6"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb8-6" tabindex="-1"></a><span class="co">#&gt; Sequences list created. </span></span>
<span id="cb8-7"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb8-7" tabindex="-1"></a><span class="co">#&gt; List with counts and frequencies created successfully. </span></span>
<span id="cb8-8"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb8-8" tabindex="-1"></a><span class="co">#&gt; Outlyingness scores for discrete variables calculated.</span></span>
<span id="cb8-9"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb8-9" tabindex="-1"></a><span class="co">#&gt; Outlyingness scores for continuous variables calculated.</span></span>
<span id="cb8-10"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb8-10" tabindex="-1"></a><span class="co">#&gt; Marginal outliers detected.</span></span>
<span id="cb8-11"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb8-11" tabindex="-1"></a><span class="fu">all</span>(<span class="fu">unique</span>(<span class="fu">unlist</span>(marginal_outliers)) <span class="sc">==</span> <span class="fu">unique</span>(<span class="fu">unlist</span>(marginal_outliers_2)))</span>
<span id="cb8-12"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb8-12" tabindex="-1"></a><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</div>
<div id="detecting-associations-between-variables---assoc_detect_xgb" class="section level2">
<h2>Detecting associations between variables -
<code>assoc_detect_xgb</code></h2>
<p>Once we have detected the marginal outliers in our data set, we can
look for joint outliers as well. These are defined as innocent-looking
observations with their discrete features taking typical levels, while
their continuous values are not too far away from the rest of the data
points. As a result, their discrete and continuous scores are low enough
and they cannot be detected together with the marginal outliers.
However, these observations are outlying in the sense that they do not
follow an existing pattern or association between features of
distinct types. In practice, these associations will typically be
defined between a discrete and a set of continuous features and they
will (in most cases) be unknown to the user. Thus, we seek to detect
these associations somehow.</p>
<p>The function <code>assoc_detect_xgb</code> uses the
<code>xgboost</code> classifier to perform multi-class classification of
the levels of each discrete feature using all continuous variables in
the data as predictors. The rationale behind the use of a gradient
boosting algorithm is that it can also output the importance of each
feature, which can serve as a very useful feature selection guide to the
user, should they detect an association. The function performs
Stratified K-Fold Cross Validation, where the default value is
<code>K=5</code>. It also takes as input the continuous scores and the
matrix of contributions, as well as the indices of the observations of
marginal outliers. These are used for weighing the observations
appropriately, based on whether they have been found to be marginally
outlying. The loss function is a weighted version of the cross entropy
loss:</p>
<p><span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;/msup&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;Y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mfrac&gt;&lt;munderover&gt;&lt;mo movablelimits=&quot;false&quot;&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/munderover&gt;&lt;munderover&gt;&lt;mo movablelimits=&quot;false&quot;&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn mathvariant=&quot;double-struck&quot;&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 27.86em; display: inline-block;"><span style="display: inline-block; position: relative; width: 23.217em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.193em, 1023.16em, 4.586em, -999.997em); top: -3.211em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="msubsup" id="MathJax-Span-3"><span style="display: inline-block; position: relative; width: 1.491em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="texatom" id="MathJax-Span-4"><span class="mrow" id="MathJax-Span-5"><span class="mi" id="MathJax-Span-6" style="font-family: MathJax_Caligraphic;">L</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.717em;"><span class="mi" id="MathJax-Span-7" style="font-size: 70.7%; font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mrow" id="MathJax-Span-8" style="padding-left: 0.182em;"><span class="mo" id="MathJax-Span-9" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">(</span></span><span class="mrow" id="MathJax-Span-10"><span class="msubsup" id="MathJax-Span-11"><span style="display: inline-block; position: relative; width: 1.848em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.96em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-12" style="font-family: MathJax_Math-bold-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.955em;"><span class="texatom" id="MathJax-Span-13"><span class="mrow" id="MathJax-Span-14"><span class="msubsup" id="MathJax-Span-15"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-16" style="font-size: 70.7%; font-family: MathJax_Math-italic;">D</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.866em; left: 0.598em;"><span class="mi" id="MathJax-Span-17" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-18" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-19" style="padding-left: 0.182em;"><span class="mrow" id="MathJax-Span-20"><span class="munderover" id="MathJax-Span-21"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-22" style="font-family: MathJax_Math-bold-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.098em, 1000.42em, 3.634em, -999.997em); top: -4.283em; left: 0.36em;"><span class="mo" id="MathJax-Span-23" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span></span><span class="mo" id="MathJax-Span-24" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">)</span></span></span><span class="mo" id="MathJax-Span-25" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="mo" id="MathJax-Span-26" style="font-family: MathJax_Main; padding-left: 0.301em;"></span><span class="mfrac" id="MathJax-Span-27"><span style="display: inline-block; position: relative; width: 0.717em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.158em, 1000.42em, 4.17em, -999.997em); top: -4.64em; left: 50%; margin-left: -0.235em;"><span class="mn" id="MathJax-Span-28" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.6em, 4.17em, -999.997em); top: -3.271em; left: 50%; margin-left: -0.295em;"><span class="mi" id="MathJax-Span-29" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1000.72em, 1.253em, -999.997em); top: -1.307em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.717em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span><span class="munderover" id="MathJax-Span-30" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(2.86em, 1001.37em, 4.646em, -999.997em); top: -3.985em; left: 0em;"><span class="mo" id="MathJax-Span-31" style="font-family: MathJax_Size2; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1001.07em, 4.289em, -999.997em); top: -2.914em; left: 0.122em;"><span class="texatom" id="MathJax-Span-32"><span class="mrow" id="MathJax-Span-33"><span class="mi" id="MathJax-Span-34" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-35" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-36" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -5.116em; left: 0.539em;"><span class="mi" id="MathJax-Span-37" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="munderover" id="MathJax-Span-38" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.432em; height: 0px;"><span style="position: absolute; clip: rect(2.86em, 1001.37em, 4.646em, -999.997em); top: -3.985em; left: 0em;"><span class="mo" id="MathJax-Span-39" style="font-family: MathJax_Size2; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1001.07em, 4.289em, -999.997em); top: -2.854em; left: 0.182em;"><span class="texatom" id="MathJax-Span-40"><span class="mrow" id="MathJax-Span-41"><span class="mi" id="MathJax-Span-42" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-43" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-44" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.217em, 1000.54em, 4.348em, -999.997em); top: -5.235em; left: 0.42em;"><span class="texatom" id="MathJax-Span-45"><span class="mrow" id="MathJax-Span-46"><span class="msubsup" id="MathJax-Span-47"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.3em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-48" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.866em; left: 0.301em;"><span class="mi" id="MathJax-Span-49" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-50" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.551em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.72em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-51" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.717em;"><span class="texatom" id="MathJax-Span-52"><span class="mrow" id="MathJax-Span-53"><span class="mi" id="MathJax-Span-54" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-55" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-56" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="texatom" id="MathJax-Span-57"><span class="mrow" id="MathJax-Span-58"><span class="mn" id="MathJax-Span-59" style="font-family: MathJax_Main;">1</span></span></span><span class="mo" id="MathJax-Span-60" style="font-family: MathJax_Main;">{</span><span class="msubsup" id="MathJax-Span-61"><span style="display: inline-block; position: relative; width: 1.908em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.54em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-62" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.598em;"><span class="texatom" id="MathJax-Span-63"><span class="mrow" id="MathJax-Span-64"><span class="mi" id="MathJax-Span-65" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-66" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-67"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-68" style="font-size: 70.7%; font-family: MathJax_Math-italic;">D</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.866em; left: 0.598em;"><span class="mi" id="MathJax-Span-69" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-70" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="mi" id="MathJax-Span-71" style="font-family: MathJax_Math-italic; padding-left: 0.301em;">l</span><span class="mo" id="MathJax-Span-72" style="font-family: MathJax_Main;">}</span><span class="mi" id="MathJax-Span-73" style="font-family: MathJax_Main; padding-left: 0.182em;">log</span><span class="mo" id="MathJax-Span-74"></span><span class="mrow" id="MathJax-Span-75"><span class="mo" id="MathJax-Span-76" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">(</span></span><span class="msubsup" id="MathJax-Span-77"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.039em, 1000.48em, 4.348em, -999.997em); top: -3.985em; left: 0em;"><span class="texatom" id="MathJax-Span-78"><span class="mrow" id="MathJax-Span-79"><span class="munderover" id="MathJax-Span-80"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-81" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.098em, 1000.42em, 3.634em, -999.997em); top: -4.045em; left: 0.063em;"><span class="mo" id="MathJax-Span-82" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.747em; left: 0.598em;"><span class="texatom" id="MathJax-Span-83"><span class="mrow" id="MathJax-Span-84"><span class="mi" id="MathJax-Span-85" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-86" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-87" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-88" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">)</span></span></span><span class="mo" id="MathJax-Span-89" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 3.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.496em; border-left: 0px solid; width: 0px; height: 3.861em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">L</mi></mrow><mi>W</mi></msup><mrow><mo>(</mo><mrow><msub><mi mathvariant="bold-italic">X</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>D</mi><mi>j</mi></msub></mrow></msub><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi mathvariant="bold-italic">Y</mi><mo stretchy="false">^</mo></mover></mrow></mrow><mo>)</mo></mrow><mo>=</mo><mo></mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo movablelimits="false"></mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><munderover><mo movablelimits="false"></mo><mrow class="MJX-TeXAtom-ORD"><mi>l</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi></mi><mi>j</mi></msub></mrow></munderover><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mn mathvariant="double-struck">1</mn></mrow><mo fence="false" stretchy="false">{</mo><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>,</mo><msub><mi>D</mi><mi>j</mi></msub></mrow></msub><mo>=</mo><mi>l</mi><mo fence="false" stretchy="false">}</mo><mi>log</mi><mo></mo><mrow><mo>(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>,</mo><mi>l</mi></mrow></msub><mo>)</mo></mrow><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-1">\mathcal{L}^W\left(\boldsymbol{X}_{D_j},
\hat{\boldsymbol{Y}} \right) = -\frac{1}{n} \sum\limits_{i=1}^n
\sum\limits_{l=1}^{\ell_j}w_{i,j}\mathbb{1}\{ x_{i, D_j} = l \}
\log\left(\hat{y}_{i,l} \right).</script></span></p>
<p>In the above expression, <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-90" style="width: 1.908em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.551em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1001.55em, 2.622em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-91"><span class="msubsup" id="MathJax-Span-92"><span style="display: inline-block; position: relative; width: 1.551em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.72em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-93" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.717em;"><span class="texatom" id="MathJax-Span-94"><span class="mrow" id="MathJax-Span-95"><span class="mi" id="MathJax-Span-96" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-97" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-98" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-2">w_{i,j}</script></span>
is the weight of observation <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-99" style="width: 0.479em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.36em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1000.3em, 2.324em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-100"><span class="mi" id="MathJax-Span-101" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-3">i</script></span> when
performing classification of the <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-102" style="width: 0.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1000.42em, 2.503em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-103"><span class="mi" id="MathJax-Span-104" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-4">j</script></span>th discrete feature. Then, <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-105" style="width: 2.265em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.848em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1001.85em, 2.682em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-106"><span class="msubsup" id="MathJax-Span-107"><span style="display: inline-block; position: relative; width: 1.848em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.96em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-108" style="font-family: MathJax_Math-bold-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.955em;"><span class="texatom" id="MathJax-Span-109"><span class="mrow" id="MathJax-Span-110"><span class="msubsup" id="MathJax-Span-111"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-112" style="font-size: 70.7%; font-family: MathJax_Math-italic;">D</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.866em; left: 0.598em;"><span class="mi" id="MathJax-Span-113" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.496em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="bold-italic">X</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>D</mi><mi>j</mi></msub></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-5">\boldsymbol{X}_{D_j}</script></span> is the <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-114" style="width: 0.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1000.42em, 2.503em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-115"><span class="mi" id="MathJax-Span-116" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-6">j</script></span>th discrete feature, <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;Y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-117" style="width: 1.074em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.955em, 1000.9em, 2.324em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-118"><span class="texatom" id="MathJax-Span-119"><span class="mrow" id="MathJax-Span-120"><span class="munderover" id="MathJax-Span-121"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-122" style="font-family: MathJax_Math-bold-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.098em, 1000.42em, 3.634em, -999.997em); top: -4.283em; left: 0.36em;"><span class="mo" id="MathJax-Span-123" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi mathvariant="bold-italic">Y</mi><mo stretchy="false">^</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-7">\hat{\boldsymbol{Y}}</script></span> is a stochastic
matrix where the <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-124" style="width: 2.503em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.086em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1001.97em, 2.622em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-125"><span class="mo" id="MathJax-Span-126" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-127" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-128" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-129" style="font-family: MathJax_Math-italic; padding-left: 0.182em;">l</span><span class="mo" id="MathJax-Span-130" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>k</mi><mo>,</mo><mi>l</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-8">(k,l)</script></span>th entry
represents the probability that the <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-131" style="width: 0.658em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1000.54em, 2.324em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-132"><span class="mi" id="MathJax-Span-133" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-9">k</script></span>th observation takes level <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-134" style="width: 0.36em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.301em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1000.24em, 2.324em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-135"><span class="mi" id="MathJax-Span-136" style="font-family: MathJax_Math-italic;">l</span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi></math></span></span><script type="math/tex" id="MathJax-Element-10">l</script></span>, <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-137" style="width: 0.717em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1000.6em, 2.324em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-138"><span class="mi" id="MathJax-Span-139" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-11">n</script></span>
is the total number of observations in the data set, <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-140" style="width: 0.955em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1000.78em, 2.622em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-141"><span class="msubsup" id="MathJax-Span-142"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-143" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.42em;"><span class="mi" id="MathJax-Span-144" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi></mi><mi>j</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-12">\ell_j</script></span> is the total number of discrete
levels that <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-145" style="width: 2.265em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.848em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1001.85em, 2.682em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-146"><span class="msubsup" id="MathJax-Span-147"><span style="display: inline-block; position: relative; width: 1.848em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.96em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-148" style="font-family: MathJax_Math-bold-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.955em;"><span class="texatom" id="MathJax-Span-149"><span class="mrow" id="MathJax-Span-150"><span class="msubsup" id="MathJax-Span-151"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.6em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-152" style="font-size: 70.7%; font-family: MathJax_Math-italic;">D</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.866em; left: 0.598em;"><span class="mi" id="MathJax-Span-153" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.496em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="bold-italic">X</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>D</mi><mi>j</mi></msub></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-13">\boldsymbol{X}_{D_j}</script></span>
takes and <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-154" style="width: 1.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.193em, 1001.31em, 2.682em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-155"><span class="msubsup" id="MathJax-Span-156"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.039em, 1000.48em, 4.348em, -999.997em); top: -3.985em; left: 0em;"><span class="texatom" id="MathJax-Span-157"><span class="mrow" id="MathJax-Span-158"><span class="munderover" id="MathJax-Span-159"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.48em, 4.348em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-160" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.098em, 1000.42em, 3.634em, -999.997em); top: -4.045em; left: 0.063em;"><span class="mo" id="MathJax-Span-161" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.747em; left: 0.598em;"><span class="texatom" id="MathJax-Span-162"><span class="mrow" id="MathJax-Span-163"><span class="mi" id="MathJax-Span-164" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-165" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-166" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.496em; border-left: 0px solid; width: 0px; height: 1.504em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>,</mo><mi>l</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-14">\hat{y}_{i,l}</script></span> is the
<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-167" style="width: 2.324em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.908em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1001.79em, 2.622em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-168"><span class="mo" id="MathJax-Span-169" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-170" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-171" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-172" style="font-family: MathJax_Math-italic; padding-left: 0.182em;">l</span><span class="mo" id="MathJax-Span-173" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>l</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-15">(i,l)</script></span>th entry of <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;Y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-174" style="width: 1.074em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.955em, 1000.9em, 2.324em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-175"><span class="texatom" id="MathJax-Span-176"><span class="mrow" id="MathJax-Span-177"><span class="munderover" id="MathJax-Span-178"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.9em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-179" style="font-family: MathJax_Math-bold-italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.098em, 1000.42em, 3.634em, -999.997em); top: -4.283em; left: 0.36em;"><span class="mo" id="MathJax-Span-180" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi mathvariant="bold-italic">Y</mi><mo stretchy="false">^</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-16">\hat{\boldsymbol{Y}}</script></span>. The weights used
are given below:</p>
<p><span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;{&lt;/mo&gt;&lt;mrow&gt;&lt;mtable columnalign=&quot;left left&quot; rowspacing=&quot;1.9em 0.4em&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;munder&gt;&lt;mo form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/munder&gt;&lt;mrow&gt;&lt;mo&gt;{&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;}&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;I&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x222A;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;I&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;munder&gt;&lt;mo form=&quot;prefix&quot;&gt;min&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mrow&gt;&lt;mo&gt;{&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;}&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;munder&gt;&lt;mo form=&quot;prefix&quot;&gt;min&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/munder&gt;&lt;mrow&gt;&lt;mo&gt;{&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;}&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;munder&gt;&lt;mo form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/munder&gt;&lt;mrow&gt;&lt;mo&gt;{&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;}&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;o&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;w&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;s&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;mo fence=&quot;true&quot; stretchy=&quot;true&quot; symmetric=&quot;true&quot;&gt;&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-181" style="width: 29.765em; display: inline-block;"><span style="display: inline-block; position: relative; width: 24.765em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(2.027em, 1024.77em, 8.932em, -999.997em); top: -5.711em; left: 0em;"><span class="mrow" id="MathJax-Span-182"><span class="msubsup" id="MathJax-Span-183"><span style="display: inline-block; position: relative; width: 1.551em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.72em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-184" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.717em;"><span class="texatom" id="MathJax-Span-185"><span class="mrow" id="MathJax-Span-186"><span class="mi" id="MathJax-Span-187" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-188" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-189" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-190" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="mrow" id="MathJax-Span-191" style="padding-left: 0.301em;"><span class="mo" id="MathJax-Span-192" style="vertical-align: 3.515em;"><span style="display: inline-block; position: relative; width: 0.896em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -3.092em; left: 0em;"><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 1.67em; left: 0em;"><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -0.473em; left: 0em;"><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -2.854em; left: 0em;"><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -2.557em; left: 0em;"><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -2.318em; left: 0em;"><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -2.08em; left: 0em;"><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.842em; left: 0em;"><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.545em; left: 0em;"><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 0.42em; left: 0em;"><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 0.717em; left: 0em;"><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 0.955em; left: 0em;"><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 1.193em; left: 0em;"><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 1.432em; left: 0em;"><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: 1.729em; left: 0em;"><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mrow" id="MathJax-Span-193"><span class="mtable" id="MathJax-Span-194" style="padding-right: 0.182em; padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 20.122em; height: 0px;"><span style="position: absolute; clip: rect(3.872em, 1013.04em, 10.777em, -999.997em); top: -7.557em; left: 0em;"><span style="display: inline-block; position: relative; width: 13.098em; height: 0px;"><span style="position: absolute; clip: rect(2.801em, 1010em, 5.241em, -999.997em); top: -6.545em; left: 0em;"><span class="mtd" id="MathJax-Span-195"><span class="mrow" id="MathJax-Span-196"><span class="mn" id="MathJax-Span-197" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-198" style="font-family: MathJax_Main; padding-left: 0.241em;"></span><span class="msubsup" id="MathJax-Span-199" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 2.443em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-200" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-201"><span class="mrow" id="MathJax-Span-202"><span class="mi" id="MathJax-Span-203" style="font-size: 70.7%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-204" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-205" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-206" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-207" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-208" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mo" id="MathJax-Span-209" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-210" style="font-family: MathJax_Main; padding-left: 0.241em;"></span><span class="mfrac" id="MathJax-Span-211" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 4.11em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.515em, 1001.85em, 4.408em, -999.997em); top: -4.64em; left: 50%; margin-left: -0.89em;"><span class="msubsup" id="MathJax-Span-212"><span style="display: inline-block; position: relative; width: 1.848em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.3em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-213" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.866em; left: 0.301em;"><span class="texatom" id="MathJax-Span-214"><span class="mrow" id="MathJax-Span-215"><span class="mi" id="MathJax-Span-216" style="font-size: 50%; font-family: MathJax_Math-italic;">D</span><span class="mo" id="MathJax-Span-217" style="font-size: 50%; font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-218" style="font-size: 50%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-219" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-220" style="font-size: 50%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-221" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-222" style="font-size: 50%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.217em, 1003.87em, 4.705em, -999.997em); top: -3.449em; left: 50%; margin-left: -1.961em;"><span class="mrow" id="MathJax-Span-223"><span class="munderover" id="MathJax-Span-224"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1001.31em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mo" id="MathJax-Span-225" style="font-size: 70.7%; font-family: MathJax_Main;">max</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.455em, 1000.18em, 4.229em, -999.997em); top: -3.509em; left: 0.598em;"><span class="mi" id="MathJax-Span-226" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mrow" id="MathJax-Span-227"><span class="mo" id="MathJax-Span-228" style="vertical-align: 0em;"><span><span style="font-size: 70.7%; font-family: MathJax_Size1;">{</span></span></span><span class="msubsup" id="MathJax-Span-229"><span style="display: inline-block; position: relative; width: 1.848em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.3em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-230" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.866em; left: 0.301em;"><span class="texatom" id="MathJax-Span-231"><span class="mrow" id="MathJax-Span-232"><span class="mi" id="MathJax-Span-233" style="font-size: 50%; font-family: MathJax_Math-italic;">D</span><span class="mo" id="MathJax-Span-234" style="font-size: 50%; font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-235" style="font-size: 50%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-236" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-237" style="font-size: 50%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-238" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-239" style="font-size: 50%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-240" style="vertical-align: 0em;"><span><span style="font-size: 70.7%; font-family: MathJax_Size1;">}</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1004.11em, 1.253em, -999.997em); top: -1.307em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.11em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span><span class="mo" id="MathJax-Span-241" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(2.265em, 1013.04em, 5.241em, -999.997em); top: -2.021em; left: 0em;"><span class="mtd" id="MathJax-Span-262"><span class="mrow" id="MathJax-Span-263"><span class="mn" id="MathJax-Span-264" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-265" style="font-family: MathJax_Main; padding-left: 0.241em;"></span><span class="munderover" id="MathJax-Span-266" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.67em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1001.67em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mo" id="MathJax-Span-267" style="font-family: MathJax_Main;">min</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.24em, 4.289em, -999.997em); top: -3.33em; left: 0.717em;"><span class="texatom" id="MathJax-Span-268"><span class="mrow" id="MathJax-Span-269"><span class="mi" id="MathJax-Span-270" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mrow" id="MathJax-Span-271" style="padding-left: 0.182em;"><span class="mo" id="MathJax-Span-272" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">{</span></span><span class="msubsup" id="MathJax-Span-273"><span style="display: inline-block; position: relative; width: 2.443em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-274" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-275"><span class="mrow" id="MathJax-Span-276"><span class="mi" id="MathJax-Span-277" style="font-size: 70.7%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-278" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-279" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-280" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-281" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-282" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mo" id="MathJax-Span-283" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-284" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">}</span></span></span><span class="mo" id="MathJax-Span-285" style="font-family: MathJax_Main; padding-left: 0.241em;"></span><span class="mfrac" id="MathJax-Span-286" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 4.11em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(3.217em, 1003.75em, 4.705em, -999.997em); top: -4.938em; left: 50%; margin-left: -1.902em;"><span class="mrow" id="MathJax-Span-287"><span class="munderover" id="MathJax-Span-288"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1001.19em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mo" id="MathJax-Span-289" style="font-size: 70.7%; font-family: MathJax_Main;">min</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.455em, 1000.18em, 4.229em, -999.997em); top: -3.509em; left: 0.479em;"><span class="mi" id="MathJax-Span-290" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mrow" id="MathJax-Span-291"><span class="mo" id="MathJax-Span-292" style="vertical-align: 0em;"><span><span style="font-size: 70.7%; font-family: MathJax_Size1;">{</span></span></span><span class="msubsup" id="MathJax-Span-293"><span style="display: inline-block; position: relative; width: 1.848em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.3em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-294" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.866em; left: 0.301em;"><span class="texatom" id="MathJax-Span-295"><span class="mrow" id="MathJax-Span-296"><span class="mi" id="MathJax-Span-297" style="font-size: 50%; font-family: MathJax_Math-italic;">D</span><span class="mo" id="MathJax-Span-298" style="font-size: 50%; font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-299" style="font-size: 50%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-300" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-301" style="font-size: 50%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-302" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-303" style="font-size: 50%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-304" style="vertical-align: 0em;"><span><span style="font-size: 70.7%; font-family: MathJax_Size1;">}</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.217em, 1003.87em, 4.705em, -999.997em); top: -3.449em; left: 50%; margin-left: -1.961em;"><span class="mrow" id="MathJax-Span-305"><span class="munderover" id="MathJax-Span-306"><span style="display: inline-block; position: relative; width: 1.313em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1001.31em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mo" id="MathJax-Span-307" style="font-size: 70.7%; font-family: MathJax_Main;">max</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.455em, 1000.18em, 4.229em, -999.997em); top: -3.509em; left: 0.598em;"><span class="mi" id="MathJax-Span-308" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mrow" id="MathJax-Span-309"><span class="mo" id="MathJax-Span-310" style="vertical-align: 0em;"><span><span style="font-size: 70.7%; font-family: MathJax_Size1;">{</span></span></span><span class="msubsup" id="MathJax-Span-311"><span style="display: inline-block; position: relative; width: 1.848em; height: 0px;"><span style="position: absolute; clip: rect(3.515em, 1000.3em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-312" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.866em; left: 0.301em;"><span class="texatom" id="MathJax-Span-313"><span class="mrow" id="MathJax-Span-314"><span class="mi" id="MathJax-Span-315" style="font-size: 50%; font-family: MathJax_Math-italic;">D</span><span class="mo" id="MathJax-Span-316" style="font-size: 50%; font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-317" style="font-size: 50%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-318" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-319" style="font-size: 50%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-320" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-321" style="font-size: 50%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-322" style="vertical-align: 0em;"><span><span style="font-size: 70.7%; font-family: MathJax_Size1;">}</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1004.11em, 1.253em, -999.997em); top: -1.307em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.11em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span><span class="mo" id="MathJax-Span-323" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 7.562em;"></span></span><span style="position: absolute; clip: rect(2.801em, 1006.01em, 8.336em, -999.997em); top: -6.188em; left: 14.11em;"><span style="display: inline-block; position: relative; width: 6.015em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1006.01em, 4.348em, -999.997em); top: -6.545em; left: 0em;"><span class="mtd" id="MathJax-Span-242"><span class="mrow" id="MathJax-Span-243"><span class="texatom" id="MathJax-Span-244"><span class="mrow" id="MathJax-Span-245"><span class="mi" id="MathJax-Span-246" style="font-family: MathJax_Main;">i</span><span class="mi" id="MathJax-Span-247" style="font-family: MathJax_Main;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span></span><span class="mtext" id="MathJax-Span-248" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-249" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-250" style="font-family: MathJax_Main; padding-left: 0.301em;"></span><span class="msubsup" id="MathJax-Span-251" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="texatom" id="MathJax-Span-252"><span class="mrow" id="MathJax-Span-253"><span class="mi" id="MathJax-Span-254" style="font-family: MathJax_Caligraphic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="mi" id="MathJax-Span-255" style="font-size: 70.7%; font-family: MathJax_Math-italic;">D</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-256" style="font-family: MathJax_Main; padding-left: 0.241em;"></span><span class="msubsup" id="MathJax-Span-257" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="texatom" id="MathJax-Span-258"><span class="mrow" id="MathJax-Span-259"><span class="mi" id="MathJax-Span-260" style="font-family: MathJax_Caligraphic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="mi" id="MathJax-Span-261" style="font-size: 70.7%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.098em, 1004.35em, 4.17em, -999.997em); top: -2.021em; left: 0em;"><span class="mtd" id="MathJax-Span-324"><span class="mrow" id="MathJax-Span-325"><span class="texatom" id="MathJax-Span-326"><span class="mrow" id="MathJax-Span-327"><span class="mi" id="MathJax-Span-328" style="font-family: MathJax_Main;">o</span><span class="mi" id="MathJax-Span-329" style="font-family: MathJax_Main;">t</span><span class="mi" id="MathJax-Span-330" style="font-family: MathJax_Main;">h</span><span class="mi" id="MathJax-Span-331" style="font-family: MathJax_Main;">e</span><span class="mi" id="MathJax-Span-332" style="font-family: MathJax_Main;">r</span><span class="mi" id="MathJax-Span-333" style="font-family: MathJax_Main;">w</span><span class="mi" id="MathJax-Span-334" style="font-family: MathJax_Main;">i</span><span class="mi" id="MathJax-Span-335" style="font-family: MathJax_Main;">s</span><span class="mi" id="MathJax-Span-336" style="font-family: MathJax_Main;">e</span><span class="mo" id="MathJax-Span-337" style="font-family: MathJax_Main;">.</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.193em;"></span></span></span></span><span class="mo" id="MathJax-Span-338" style="font-family: MathJax_Main;">,</span></span><span class="mo" id="MathJax-Span-339" style="padding-left: 0.182em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.717em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -3.711em; border-left: 0px solid; width: 0px; height: 8.004em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>=</mo><mrow><mo>{</mo><mrow><mtable columnalign="left left" rowspacing="1.9em 0.4em" columnspacing="1em"><mtr><mtd><mn>2</mn><mo></mo><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>C</mi><mo>,</mo><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mo></mo><mo stretchy="false">)</mo></mrow></msub><mo></mo><mfrac><msub><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>D</mi><mo>,</mo><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow></msub><mrow><munder><mo form="prefix">max</mo><mi>i</mi></munder><mrow><mo>{</mo><msub><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>D</mi><mo>,</mo><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow></msub><mo>}</mo></mrow></mrow></mfrac><mo>,</mo></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi></mrow><mtext>&nbsp;</mtext><mi>i</mi><mo></mo><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">I</mi></mrow><mi>D</mi></msub><mo></mo><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">I</mi></mrow><mi>C</mi></msub></mtd></mtr><mtr><mtd><mn>2</mn><mo></mo><munder><mo form="prefix">min</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></munder><mrow><mo>{</mo><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>C</mi><mo>,</mo><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mo></mo><mo stretchy="false">)</mo></mrow></msub><mo>}</mo></mrow><mo></mo><mfrac><mrow><munder><mo form="prefix">min</mo><mi>i</mi></munder><mrow><mo>{</mo><msub><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>D</mi><mo>,</mo><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow></msub><mo>}</mo></mrow></mrow><mrow><munder><mo form="prefix">max</mo><mi>i</mi></munder><mrow><mo>{</mo><msub><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>D</mi><mo>,</mo><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow></msub><mo>}</mo></mrow></mrow></mfrac><mo>,</mo></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">o</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">h</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">w</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">e</mi><mo>.</mo></mrow></mtd></mtr></mtable><mo>,</mo></mrow><mo fence="true" stretchy="true" symmetric="true"></mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-17">    w_{i,j} = \left\{
\begin{array}{ll}
     2 - s_{C, (i,\cdot)} -
\frac{c_{D,(i,j)}}{\max\limits_i\left\{c_{D,(i,j)}\right\}}, &
\mathrm{if} \ i \in \mathcal{I}_D \cup \mathcal{I}_C\\[15pt]
     2 - \min\limits_{i}\left\{s_{C,(i,\cdot)}\right\} -
\frac{\min\limits_i\left\{c_{D,(i,j)}\right\}}{\max\limits_i\left\{c_{D,(i,j)}\right\}},
& \mathrm{otherwise.}\\
\end{array} ,
\right.</script></span></p>
<p>In the above expression, <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-340" style="width: 2.979em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.443em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1002.44em, 2.682em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-341"><span class="msubsup" id="MathJax-Span-342"><span style="display: inline-block; position: relative; width: 2.443em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-343" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="texatom" id="MathJax-Span-344"><span class="mrow" id="MathJax-Span-345"><span class="mi" id="MathJax-Span-346" style="font-size: 70.7%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span class="mo" id="MathJax-Span-347" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-348" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-349" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-350" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-351" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mo" id="MathJax-Span-352" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.496em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>C</mi><mo>,</mo><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mo></mo><mo stretchy="false">)</mo></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-18">s_{C, (i,
\cdot)}</script></span> is the continuous score for the <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-353" style="width: 0.479em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.36em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1000.3em, 2.324em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-354"><span class="mi" id="MathJax-Span-355" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-19">i</script></span>th observation, <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-356" style="width: 3.098em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.562em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.551em, 1002.56em, 2.682em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-357"><span class="msubsup" id="MathJax-Span-358"><span style="display: inline-block; position: relative; width: 2.562em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-359" style="font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.42em;"><span class="texatom" id="MathJax-Span-360"><span class="mrow" id="MathJax-Span-361"><span class="mi" id="MathJax-Span-362" style="font-size: 70.7%; font-family: MathJax_Math-italic;">D</span><span class="mo" id="MathJax-Span-363" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-364" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-365" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-366" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-367" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-368" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.496em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>D</mi><mo>,</mo><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-20">c_{D,(i,j)}</script></span> is the contribution of the
<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-369" style="width: 0.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1000.42em, 2.503em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-370"><span class="mi" id="MathJax-Span-371" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-21">j</script></span>th discrete variable to the
discrete score of the <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-372" style="width: 0.479em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.36em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1000.3em, 2.324em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-373"><span class="mi" id="MathJax-Span-374" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-22">i</script></span>th
observation and finally <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;I&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-375" style="width: 1.432em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1001.19em, 2.503em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-376"><span class="msubsup" id="MathJax-Span-377"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="texatom" id="MathJax-Span-378"><span class="mrow" id="MathJax-Span-379"><span class="mi" id="MathJax-Span-380" style="font-family: MathJax_Caligraphic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="mi" id="MathJax-Span-381" style="font-size: 70.7%; font-family: MathJax_Math-italic;">D</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">I</mi></mrow><mi>D</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-23">\mathcal{I}_D</script></span> and <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;I&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-382" style="width: 1.372em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1001.13em, 2.503em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-383"><span class="msubsup" id="MathJax-Span-384"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="texatom" id="MathJax-Span-385"><span class="mrow" id="MathJax-Span-386"><span class="mi" id="MathJax-Span-387" style="font-family: MathJax_Caligraphic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="mi" id="MathJax-Span-388" style="font-size: 70.7%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">I</mi></mrow><mi>C</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-24">\mathcal{I}_C</script></span> are the sets of
observations which are marginally outlying in the discrete and the
continuous domains, respectively. Hence, we can see that data points in
<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;I&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x222A;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;I&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-389" style="width: 4.17em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.455em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.372em, 1003.46em, 2.562em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-390"><span class="msubsup" id="MathJax-Span-391"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="texatom" id="MathJax-Span-392"><span class="mrow" id="MathJax-Span-393"><span class="mi" id="MathJax-Span-394" style="font-family: MathJax_Caligraphic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="mi" id="MathJax-Span-395" style="font-size: 70.7%; font-family: MathJax_Math-italic;">D</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-396" style="font-family: MathJax_Main; padding-left: 0.241em;"></span><span class="msubsup" id="MathJax-Span-397" style="padding-left: 0.241em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="texatom" id="MathJax-Span-398"><span class="mrow" id="MathJax-Span-399"><span class="mi" id="MathJax-Span-400" style="font-family: MathJax_Caligraphic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.539em;"><span class="mi" id="MathJax-Span-401" style="font-size: 70.7%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">I</mi></mrow><mi>D</mi></msub><mo></mo><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">I</mi></mrow><mi>C</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-25">\mathcal{I}_D \cup \mathcal{I}_C</script></span>
(i.e.&nbsp;marginal outliers) are assigned lower weights.</p>
<p>In our case, we have defined 2 associations; these are between the
first and the second discrete features with the first 2 continuous
variables. We will still check for associations between any discrete and
all continuous variables.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb9-1" tabindex="-1"></a>assoctns <span class="ot">&lt;-</span> <span class="fu">assoc_detect_xgb</span>(<span class="at">data =</span> dt,</span>
<span id="cb9-2"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb9-2" tabindex="-1"></a>                             <span class="at">K =</span> <span class="dv">5</span>,</span>
<span id="cb9-3"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb9-3" tabindex="-1"></a>                             <span class="at">pred_inx =</span> <span class="fu">c</span>(<span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>),</span>
<span id="cb9-4"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb9-4" tabindex="-1"></a>                             <span class="at">target_inx =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>), </span>
<span id="cb9-5"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb9-5" tabindex="-1"></a>                             <span class="at">cont_scores =</span> continuous_scores[, <span class="dv">2</span>],</span>
<span id="cb9-6"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb9-6" tabindex="-1"></a>                             <span class="at">contribs =</span> discrete_scores[[<span class="dv">3</span>]],</span>
<span id="cb9-7"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb9-7" tabindex="-1"></a>                             <span class="at">marg_outs =</span> <span class="fu">unique</span>(<span class="fu">unlist</span>(marginal_outliers)))</span>
<span id="cb9-8"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb9-8" tabindex="-1"></a><span class="co">#&gt; Fold 1 / 5 for target variable 1 complete. </span></span>
<span id="cb9-9"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb9-9" tabindex="-1"></a><span class="co">#&gt; Fold 2 / 5 for target variable 1 complete. </span></span>
<span id="cb9-10"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb9-10" tabindex="-1"></a><span class="co">#&gt; Fold 3 / 5 for target variable 1 complete. </span></span>
<span id="cb9-11"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb9-11" tabindex="-1"></a><span class="co">#&gt; Fold 4 / 5 for target variable 1 complete. </span></span>
<span id="cb9-12"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb9-12" tabindex="-1"></a><span class="co">#&gt; Fold 5 / 5 for target variable 1 complete. </span></span>
<span id="cb9-13"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb9-13" tabindex="-1"></a><span class="co">#&gt; Fold 1 / 5 for target variable 2 complete. </span></span>
<span id="cb9-14"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb9-14" tabindex="-1"></a><span class="co">#&gt; Fold 2 / 5 for target variable 2 complete. </span></span>
<span id="cb9-15"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb9-15" tabindex="-1"></a><span class="co">#&gt; Fold 3 / 5 for target variable 2 complete. </span></span>
<span id="cb9-16"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb9-16" tabindex="-1"></a><span class="co">#&gt; Fold 4 / 5 for target variable 2 complete. </span></span>
<span id="cb9-17"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb9-17" tabindex="-1"></a><span class="co">#&gt; Fold 5 / 5 for target variable 2 complete. </span></span>
<span id="cb9-18"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb9-18" tabindex="-1"></a><span class="co">#&gt; Fold 1 / 5 for target variable 3 complete. </span></span>
<span id="cb9-19"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb9-19" tabindex="-1"></a><span class="co">#&gt; Fold 2 / 5 for target variable 3 complete. </span></span>
<span id="cb9-20"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb9-20" tabindex="-1"></a><span class="co">#&gt; Fold 3 / 5 for target variable 3 complete. </span></span>
<span id="cb9-21"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb9-21" tabindex="-1"></a><span class="co">#&gt; Fold 4 / 5 for target variable 3 complete. </span></span>
<span id="cb9-22"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb9-22" tabindex="-1"></a><span class="co">#&gt; Fold 5 / 5 for target variable 3 complete. </span></span>
<span id="cb9-23"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb9-23" tabindex="-1"></a><span class="co">#&gt; Fold 1 / 5 for target variable 4 complete. </span></span>
<span id="cb9-24"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb9-24" tabindex="-1"></a><span class="co">#&gt; Fold 2 / 5 for target variable 4 complete. </span></span>
<span id="cb9-25"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb9-25" tabindex="-1"></a><span class="co">#&gt; Fold 3 / 5 for target variable 4 complete. </span></span>
<span id="cb9-26"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb9-26" tabindex="-1"></a><span class="co">#&gt; Fold 4 / 5 for target variable 4 complete. </span></span>
<span id="cb9-27"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb9-27" tabindex="-1"></a><span class="co">#&gt; Fold 5 / 5 for target variable 4 complete. </span></span>
<span id="cb9-28"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb9-28" tabindex="-1"></a><span class="co">#&gt; Fold 1 / 5 for target variable 5 complete. </span></span>
<span id="cb9-29"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb9-29" tabindex="-1"></a><span class="co">#&gt; Fold 2 / 5 for target variable 5 complete. </span></span>
<span id="cb9-30"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb9-30" tabindex="-1"></a><span class="co">#&gt; Fold 3 / 5 for target variable 5 complete. </span></span>
<span id="cb9-31"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb9-31" tabindex="-1"></a><span class="co">#&gt; Fold 4 / 5 for target variable 5 complete. </span></span>
<span id="cb9-32"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb9-32" tabindex="-1"></a><span class="co">#&gt; Fold 5 / 5 for target variable 5 complete.</span></span></code></pre></div>
<p>We explore the output of <code>assoc_detect_xgb</code>; the list
<code>assoctns</code> that we obtain includes 3 elements. The first
element includes summary statistics for the contribution (importance) of
all continuous variables when seeking to classify each of the discrete
variables used as targets, across all <code>K</code> folds. In our case,
we can see that the average contribution is significantly higher for
<code>V6</code> and <code>V7</code> (these are the first 2 continuous
variables in the data set) than for any other continuous feature when
targeting the first or the second discrete variable. If we look at the
results for the other 3 discrete features, we see that contributions
there are much closer for all 5 continuous features. Even if this could
easily be misinterpreted as a sign of an association, the 2nd element of
<code>assoctns</code> is a data frame including the misclassification
rates for each target discrete variable, from which it is evident that
only the first 2 discrete features are somehow related to a set of
continuous attributes (given the low misclassification rates).</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb10-1" tabindex="-1"></a><span class="co"># Plot contributions for each variable</span></span>
<span id="cb10-2"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb10-2" tabindex="-1"></a>contribs <span class="ot">&lt;-</span> <span class="fu">list</span>(assoctns[[<span class="dv">1</span>]][[<span class="dv">1</span>]], assoctns[[<span class="dv">1</span>]][[<span class="dv">2</span>]],</span>
<span id="cb10-3"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb10-3" tabindex="-1"></a>                 assoctns[[<span class="dv">1</span>]][[<span class="dv">3</span>]], assoctns[[<span class="dv">1</span>]][[<span class="dv">4</span>]],</span>
<span id="cb10-4"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb10-4" tabindex="-1"></a>                 assoctns[[<span class="dv">1</span>]][[<span class="dv">5</span>]])</span>
<span id="cb10-5"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb10-5" tabindex="-1"></a>contribs <span class="ot">&lt;-</span> <span class="fu">lapply</span>(contribs, <span class="cf">function</span>(dat) {</span>
<span id="cb10-6"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb10-6" tabindex="-1"></a>  dat<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">colnames</span>(dat)[<span class="dv">1</span>]</span>
<span id="cb10-7"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb10-7" tabindex="-1"></a>  <span class="fu">colnames</span>(dat)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"variable"</span></span>
<span id="cb10-8"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb10-8" tabindex="-1"></a>  dat</span>
<span id="cb10-9"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb10-9" tabindex="-1"></a>})</span>
<span id="cb10-10"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb10-10" tabindex="-1"></a>contribs <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, contribs)</span>
<span id="cb10-11"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb10-11" tabindex="-1"></a>contribs<span class="sc">$</span>Target <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">each =</span> <span class="dv">5</span>)</span>
<span id="cb10-12"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb10-12" tabindex="-1"></a></span>
<span id="cb10-13"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb10-13" tabindex="-1"></a><span class="co"># Plot contributions</span></span>
<span id="cb10-14"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb10-14" tabindex="-1"></a><span class="fu">ggplot</span>(contribs, <span class="fu">aes</span>(variable, Avg_Contrib)) <span class="sc">+</span></span>
<span id="cb10-15"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb10-15" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">'cyan3'</span>, <span class="at">col=</span><span class="st">'black'</span>) <span class="sc">+</span></span>
<span id="cb10-16"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb10-16" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Target, <span class="at">scales =</span> <span class="st">"free_x"</span>,</span>
<span id="cb10-17"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb10-17" tabindex="-1"></a>             <span class="at">labeller =</span> <span class="fu">as_labeller</span>(<span class="fu">c</span>(<span class="st">'1'</span> <span class="ot">=</span> <span class="st">"Discrete Variable 1"</span>,</span>
<span id="cb10-18"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb10-18" tabindex="-1"></a>                                      <span class="st">'2'</span> <span class="ot">=</span> <span class="st">"Discrete Variable 2"</span>,</span>
<span id="cb10-19"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb10-19" tabindex="-1"></a>                                      <span class="st">'3'</span> <span class="ot">=</span> <span class="st">"Discrete Variable 3"</span>,</span>
<span id="cb10-20"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb10-20" tabindex="-1"></a>                                      <span class="st">'4'</span> <span class="ot">=</span> <span class="st">"Discrete Variable 4"</span>,</span>
<span id="cb10-21"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb10-21" tabindex="-1"></a>                                      <span class="st">'5'</span> <span class="ot">=</span> <span class="st">"Discrete Variable 5"</span>))) <span class="sc">+</span></span>
<span id="cb10-22"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb10-22" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">'Continuous Variable'</span>) <span class="sc">+</span></span>
<span id="cb10-23"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb10-23" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'Average Contribution'</span>) <span class="sc">+</span> </span>
<span id="cb10-24"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb10-24" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">'Contributions of continuous variables</span><span class="sc">\n</span><span class="st">to classification of discrete features'</span>) <span class="sc">+</span></span>
<span id="cb10-25"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb10-25" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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"><!-- --></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb11-1" tabindex="-1"></a></span>
<span id="cb11-2"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb11-2" tabindex="-1"></a><span class="co"># Misclassification rates</span></span>
<span id="cb11-3"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb11-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb11-4"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb11-4" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">'Misclassification rate for target discrete variable'</span>,</span>
<span id="cb11-5"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb11-5" tabindex="-1"></a>      i, <span class="st">':'</span>, assoctns[[<span class="dv">2</span>]][i, <span class="dv">3</span>], <span class="st">'</span><span class="sc">\n</span><span class="st">'</span>)</span>
<span id="cb11-6"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb11-6" tabindex="-1"></a>}</span>
<span id="cb11-7"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb11-7" tabindex="-1"></a><span class="co">#&gt; Misclassification rate for target discrete variable 1 : 0.116 </span></span>
<span id="cb11-8"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb11-8" tabindex="-1"></a><span class="co">#&gt; Misclassification rate for target discrete variable 2 : 0.148 </span></span>
<span id="cb11-9"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb11-9" tabindex="-1"></a><span class="co">#&gt; Misclassification rate for target discrete variable 3 : 0.413 </span></span>
<span id="cb11-10"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb11-10" tabindex="-1"></a><span class="co">#&gt; Misclassification rate for target discrete variable 4 : 0.553 </span></span>
<span id="cb11-11"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb11-11" tabindex="-1"></a><span class="co">#&gt; Misclassification rate for target discrete variable 5 : 0.608</span></span></code></pre></div>
<p>The third and final output of the <code>assoc_detect_xgb</code>
function is a vector of length equal to the number of observations,
including the weights that were assigned to each observation when
targeting the discrete variables. We only give a summary of the weights
used for the classification of the first discrete feature,
distinguishing between marginal and non-marginal outliers; as expected,
the weights for the marginal outliers are lower in general. The weights
for the non-marginal outliers are also all equal, which is something
expected by the way the observations were weighed. The rationale is that
assuming none of these observations have been previously flagged as
outlying in either of the 2 domains, they should contribute equally to
the whole classification process.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb12-1" tabindex="-1"></a><span class="co"># Summary for marginal outliers</span></span>
<span id="cb12-2"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb12-2" tabindex="-1"></a><span class="fu">summary</span>(assoctns[[<span class="dv">3</span>]][[<span class="dv">1</span>]][<span class="fu">unique</span>(<span class="fu">unlist</span>(marginal_outliers))])</span>
<span id="cb12-3"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb12-3" tabindex="-1"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb12-4"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb12-4" tabindex="-1"></a><span class="co">#&gt;  0.5788  1.2694  1.3024  1.3288  1.5918  1.6996</span></span>
<span id="cb12-5"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb12-5" tabindex="-1"></a></span>
<span id="cb12-6"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb12-6" tabindex="-1"></a><span class="co"># Summary for non-marginal outliers</span></span>
<span id="cb12-7"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb12-7" tabindex="-1"></a><span class="fu">summary</span>(assoctns[[<span class="dv">3</span>]][[<span class="dv">1</span>]][<span class="sc">-</span><span class="fu">unique</span>(<span class="fu">unlist</span>(marginal_outliers))])</span>
<span id="cb12-8"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb12-8" tabindex="-1"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb12-9"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb12-9" tabindex="-1"></a><span class="co">#&gt;   1.713   1.713   1.713   1.713   1.713   1.713</span></span></code></pre></div>
</div>
<div id="detecting-joint-outliers---kde_classif-elbow_angle-consec_angles-joint_outs" class="section level2">
<h2>Detecting joint outliers - <code>kde_classif</code>,
<code>elbow_angle</code>, <code>consec_angles</code> &amp;
<code>joint_outs</code></h2>
<p>Based on our findings above, it is safe to assert that there exists
an association between the first and the second discrete variables and
the first 2 continuous features. However, we still need to devise a
method for detecting the observations (if any) which do not conform to
the pattern that has been identified. Our strategy involves using KDE
classification and looking at the misclassified observations among the
data points which were not flagged as marginal outliers. In our case,
the classes are overlapping - indeed, if we look back at the projection
of the data in the first 2 continuous features that we plotted once we
generated our data, the classes are separable but points on the
boundaries can also be seen to blend with the neighbouring class. As a
result of this overlap, we expect a much larger number of
misclassifications than the actual number of joint outliers. At the same
time, these points close to the boundary are misclassified but the
values of the kernel density estimators under the true and the falsely
predicted classes will not differ much. Thus, we define the KDE
ratio:</p>
<p><span class="math display"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;munder&gt;&lt;mo form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msubsup&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;J&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;u&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msubsup&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;J&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-402" style="width: 12.979em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.777em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(-0.652em, 1010.72em, 3.932em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-403"><span class="msubsup" id="MathJax-Span-404"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-405" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.717em;"><span class="mi" id="MathJax-Span-406" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-407" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="mfrac" id="MathJax-Span-408" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 7.86em; height: 0px; margin-right: 0.122em; margin-left: 0.122em;"><span style="position: absolute; clip: rect(2.622em, 1007.56em, 5.182em, -999.997em); top: -5.473em; left: 50%; margin-left: -3.866em;"><span class="mrow" id="MathJax-Span-409"><span class="munderover" id="MathJax-Span-410"><span style="display: inline-block; position: relative; width: 2.92em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1001.85em, 4.17em, -999.997em); top: -3.985em; left: 0.539em;"><span class="mo" id="MathJax-Span-411" style="font-family: MathJax_Main;">max</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1002.92em, 4.467em, -999.997em); top: -3.33em; left: 0em;"><span class="texatom" id="MathJax-Span-412"><span class="mrow" id="MathJax-Span-413"><span class="mi" id="MathJax-Span-414" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-415" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-416" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-417" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-418" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mo" id="MathJax-Span-419" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-420"><span style="display: inline-block; position: relative; width: 0.539em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.3em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-421" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.866em; left: 0.301em;"><span class="mi" id="MathJax-Span-422" style="font-size: 50%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-423" style="padding-left: 0.182em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(2.801em, 1000.66em, 4.348em, -999.997em); top: -3.985em; left: 0em;"><span class="texatom" id="MathJax-Span-424"><span class="mrow" id="MathJax-Span-425"><span class="munderover" id="MathJax-Span-426"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.54em, 4.348em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-427" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.098em, 1000.42em, 3.634em, -999.997em); top: -4.283em; left: 0.241em;"><span class="mo" id="MathJax-Span-428" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.36em, 4.289em, -999.997em); top: -4.699em; left: 0.777em;"><span class="mi" id="MathJax-Span-429" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.3em, 4.17em, -999.997em); top: -3.747em; left: 0.777em;"><span class="mi" id="MathJax-Span-430" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mrow" id="MathJax-Span-431" style="padding-left: 0.182em;"><span class="mo" id="MathJax-Span-432" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">(</span></span><span class="msubsup" id="MathJax-Span-433"><span style="display: inline-block; position: relative; width: 2.443em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.96em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-434" style="font-family: MathJax_Math-bold-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.955em;"><span class="texatom" id="MathJax-Span-435"><span class="mrow" id="MathJax-Span-436"><span class="mi" id="MathJax-Span-437" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-438" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-439"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.54em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-440" style="font-size: 70.7%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.866em; left: 0.479em;"><span class="texatom" id="MathJax-Span-441"><span class="mrow" id="MathJax-Span-442"><span class="mi" id="MathJax-Span-443" style="font-size: 50%; font-family: MathJax_Caligraphic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-444" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(2.622em, 1005.36em, 4.527em, -999.997em); top: -2.795em; left: 50%; margin-left: -2.735em;"><span class="mrow" id="MathJax-Span-445"><span class="msubsup" id="MathJax-Span-446"><span style="display: inline-block; position: relative; width: 1.967em; height: 0px;"><span style="position: absolute; clip: rect(2.801em, 1000.66em, 4.348em, -999.997em); top: -3.985em; left: 0em;"><span class="texatom" id="MathJax-Span-447"><span class="mrow" id="MathJax-Span-448"><span class="munderover" id="MathJax-Span-449"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.54em, 4.348em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-450" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.098em, 1000.42em, 3.634em, -999.997em); top: -4.283em; left: 0.241em;"><span class="mo" id="MathJax-Span-451" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.36em, 4.289em, -999.997em); top: -4.699em; left: 0.777em;"><span class="mi" id="MathJax-Span-452" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.217em, 1001.25em, 4.17em, -999.997em); top: -3.747em; left: 0.777em;"><span class="texatom" id="MathJax-Span-453"><span class="mrow" id="MathJax-Span-454"><span class="msubsup" id="MathJax-Span-455"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.18em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-456" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.283em; left: 0.241em;"><span class="texatom" id="MathJax-Span-457"><span class="mrow" id="MathJax-Span-458"><span class="mi" id="MathJax-Span-459" style="font-size: 50%; font-family: MathJax_Main;">t</span><span class="mi" id="MathJax-Span-460" style="font-size: 50%; font-family: MathJax_Main;">r</span><span class="mi" id="MathJax-Span-461" style="font-size: 50%; font-family: MathJax_Main;">u</span><span class="mi" id="MathJax-Span-462" style="font-size: 50%; font-family: MathJax_Main;">e</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mrow" id="MathJax-Span-463" style="padding-left: 0.182em;"><span class="mo" id="MathJax-Span-464" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">(</span></span><span class="msubsup" id="MathJax-Span-465"><span style="display: inline-block; position: relative; width: 2.443em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.96em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-466" style="font-family: MathJax_Math-bold-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.955em;"><span class="texatom" id="MathJax-Span-467"><span class="mrow" id="MathJax-Span-468"><span class="mi" id="MathJax-Span-469" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-470" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-471"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.54em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-472" style="font-size: 70.7%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.866em; left: 0.479em;"><span class="texatom" id="MathJax-Span-473"><span class="mrow" id="MathJax-Span-474"><span class="mi" id="MathJax-Span-475" style="font-size: 50%; font-family: MathJax_Caligraphic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-476" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1007.86em, 1.253em, -999.997em); top: -1.307em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 7.86em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.074em;"></span></span></span></span><span class="mo" id="MathJax-Span-477" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.925em; border-left: 0px solid; width: 0px; height: 5.218em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi mathvariant="normal"></mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><munder><mo form="prefix">max</mo><mrow class="MJX-TeXAtom-ORD"><mi>l</mi><mo>=</mo><mn>1</mn><mo>,</mo><mo></mo><mo>,</mo><msub><mi></mi><mi>j</mi></msub></mrow></munder><msubsup><mrow class="MJX-TeXAtom-ORD"><mover><mi>f</mi><mo stretchy="false">^</mo></mover></mrow><mi>l</mi><mi>j</mi></msubsup><mrow><mo>(</mo><msub><mi mathvariant="bold-italic">X</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>,</mo><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">J</mi></mrow></msub></mrow></msub><mo>)</mo></mrow></mrow><mrow><msubsup><mrow class="MJX-TeXAtom-ORD"><mover><mi>f</mi><mo stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><msup><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">t</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">e</mi></mrow></msup></mrow><mi>j</mi></msubsup><mrow><mo>(</mo><msub><mi mathvariant="bold-italic">X</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>,</mo><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">J</mi></mrow></msub></mrow></msub><mo>)</mo></mrow></mrow></mfrac><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-26">\Lambda_i = \frac{\max\limits_{l=1,
\dots, \ell_j}\hat{f}^j_l\left(\boldsymbol{X}_{i,
C_\mathcal{J}}\right)}{\hat{f}^j_{l^\mathrm{true}}\left(\boldsymbol{X}_{i,
C_\mathcal{J}}\right)}.</script></span></p>
<p>The KDE ratio will be equal to a unit if the maximum kernel density
estimator is achieved for the true level <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;u&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-478" style="width: 2.086em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.729em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.193em, 1001.73em, 2.324em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-479"><span class="msubsup" id="MathJax-Span-480"><span style="display: inline-block; position: relative; width: 1.729em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-481" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -4.342em; left: 0.42em;"><span class="texatom" id="MathJax-Span-482"><span class="mrow" id="MathJax-Span-483"><span class="mi" id="MathJax-Span-484" style="font-size: 70.7%; font-family: MathJax_Main;">t</span><span class="mi" id="MathJax-Span-485" style="font-size: 70.7%; font-family: MathJax_Main;">r</span><span class="mi" id="MathJax-Span-486" style="font-size: 70.7%; font-family: MathJax_Main;">u</span><span class="mi" id="MathJax-Span-487" style="font-size: 70.7%; font-family: MathJax_Main;">e</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi></mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">t</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">e</mi></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-27">\ell^\mathrm{true}</script></span>, otherwise it will
exceed 1. Notice that <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-488" style="width: 1.372em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(0.777em, 1001.13em, 2.562em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-489"><span class="msubsup" id="MathJax-Span-490"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(2.801em, 1000.66em, 4.348em, -999.997em); top: -3.985em; left: 0em;"><span class="texatom" id="MathJax-Span-491"><span class="mrow" id="MathJax-Span-492"><span class="munderover" id="MathJax-Span-493"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.54em, 4.348em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-494" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.098em, 1000.42em, 3.634em, -999.997em); top: -4.283em; left: 0.241em;"><span class="mo" id="MathJax-Span-495" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.36em, 4.289em, -999.997em); top: -4.699em; left: 0.777em;"><span class="mi" id="MathJax-Span-496" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.3em, 4.17em, -999.997em); top: -3.747em; left: 0.777em;"><span class="mi" id="MathJax-Span-497" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mrow class="MJX-TeXAtom-ORD"><mover><mi>f</mi><mo stretchy="false">^</mo></mover></mrow><mi>l</mi><mi>j</mi></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-28">\hat{f}_l^j</script></span>
refers to the kernel density estimator for the <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-498" style="width: 0.36em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.301em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1000.24em, 2.324em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-499"><span class="mi" id="MathJax-Span-500" style="font-family: MathJax_Math-italic;">l</span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi></math></span></span><script type="math/tex" id="MathJax-Element-29">l</script></span>th level of the <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-501" style="width: 0.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1000.42em, 2.503em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-502"><span class="mi" id="MathJax-Span-503" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-30">j</script></span>th discrete variable, while <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold-italic&quot;&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;J&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-504" style="width: 2.979em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.443em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1002.44em, 2.622em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-505"><span class="msubsup" id="MathJax-Span-506"><span style="display: inline-block; position: relative; width: 2.443em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.96em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-507" style="font-family: MathJax_Math-bold-italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.955em;"><span class="texatom" id="MathJax-Span-508"><span class="mrow" id="MathJax-Span-509"><span class="mi" id="MathJax-Span-510" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-511" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-512"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.336em, 1000.54em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-513" style="font-size: 70.7%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.866em; left: 0.479em;"><span class="texatom" id="MathJax-Span-514"><span class="mrow" id="MathJax-Span-515"><span class="mi" id="MathJax-Span-516" style="font-size: 50%; font-family: MathJax_Caligraphic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="bold-italic">X</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>,</mo><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">J</mi></mrow></msub></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-31">\boldsymbol{X}_{i, C_\mathcal{J}}</script></span> is the
vector of values of the continuous variables <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;J&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-517" style="width: 1.67em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1001.37em, 2.562em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-518"><span class="msubsup" id="MathJax-Span-519"><span style="display: inline-block; position: relative; width: 1.372em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.78em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-520" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.063em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.717em;"><span class="texatom" id="MathJax-Span-521"><span class="mrow" id="MathJax-Span-522"><span class="mi" id="MathJax-Span-523" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.122em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">J</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-32">C_\mathcal{J}</script></span> which are associated with
the <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-524" style="width: 0.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1000.42em, 2.503em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-525"><span class="mi" id="MathJax-Span-526" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-33">j</script></span>th discrete variable, for the
<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-527" style="width: 0.479em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.36em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1000.3em, 2.324em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-528"><span class="mi" id="MathJax-Span-529" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-34">i</script></span>th observation.</p>
<p>Our goal is to find an optimal threshold value <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-530" style="width: 1.372em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1001.13em, 2.622em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-531"><span class="msubsup" id="MathJax-Span-532"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-533" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.455em, 1000.42em, 4.17em, -999.997em); top: -4.283em; left: 0.717em;"><span class="mo" id="MathJax-Span-534" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.3em, 4.17em, -999.997em); top: -3.688em; left: 0.717em;"><span class="mi" id="MathJax-Span-535" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi mathvariant="normal"></mi><mi>i</mi><mo></mo></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-35">\Lambda^*_i</script></span> value, such that the joint
outliers are the misclassified observations for which <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-536" style="width: 4.229em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.515em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1003.51em, 2.682em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-537"><span class="msubsup" id="MathJax-Span-538"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-539" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.717em;"><span class="mi" id="MathJax-Span-540" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-541" style="font-family: MathJax_Main; padding-left: 0.301em;">&gt;</span><span class="msubsup" id="MathJax-Span-542" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-543" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.455em, 1000.42em, 4.17em, -999.997em); top: -4.283em; left: 0.717em;"><span class="mo" id="MathJax-Span-544" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.3em, 4.17em, -999.997em); top: -3.688em; left: 0.717em;"><span class="mi" id="MathJax-Span-545" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal"></mi><mi>i</mi></msub><mo>&gt;</mo><msubsup><mi mathvariant="normal"></mi><mi>i</mi><mo></mo></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-36">\Lambda_i > \Lambda^*_i</script></span>. This way, we
can restrict the number of misclassified points close to the borders to
be treated as joint outliers. The function <code>kde_classif</code> uses
the <code>locfit</code> package to perform KDE classification of a
discrete variable given a set of associated continuous features. The
function requires specifying which observations are marginally outlying,
so that these are discarded from the sample. Moreover, it lets the user
specify the kernel to be used (by default the Gaussian kernel is used),
as well as the value of the parameter <code>alpha_val</code> which is
related to the adaptive nearest neighbours bandwidth that is used by
<code>locfit</code> (see the package documentation for more details).
Finally, <code>kde_classif</code> requires a threshold parameter
<code>Lambda_i</code>; this can either be a number at least equal to 1,
the value 0 (default), or a vector of values. Setting this equal to a
value of 1 will simply return the misclassified observations, then any
value larger than that will impose the additional constraint that <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-546" style="width: 1.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1001.01em, 2.503em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-547"><span class="msubsup" id="MathJax-Span-548"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-549" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.717em;"><span class="mi" id="MathJax-Span-550" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal"></mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-37">\Lambda_i</script></span> should be greater than the
value of <code>Lambda_i</code> and will return these observations
instead. The default value <code>Lambda_i = 0</code> will return the
misclassified observations for <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1.5&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;20&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-551" style="width: 9.646em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.039em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1007.98em, 2.682em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-552"><span class="msubsup" id="MathJax-Span-553"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-554" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.455em, 1000.42em, 4.17em, -999.997em); top: -4.283em; left: 0.717em;"><span class="mo" id="MathJax-Span-555" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.3em, 4.17em, -999.997em); top: -3.688em; left: 0.717em;"><span class="mi" id="MathJax-Span-556" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-557" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="mn" id="MathJax-Span-558" style="font-family: MathJax_Main; padding-left: 0.301em;">1</span><span class="mo" id="MathJax-Span-559" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-560" style="font-family: MathJax_Main; padding-left: 0.182em;">1.5</span><span class="mo" id="MathJax-Span-561" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-562" style="font-family: MathJax_Main; padding-left: 0.182em;"></span><span class="mo" id="MathJax-Span-563" style="font-family: MathJax_Main; padding-left: 0.182em;">,</span><span class="mn" id="MathJax-Span-564" style="font-family: MathJax_Main; padding-left: 0.182em;">20</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi mathvariant="normal"></mi><mi>i</mi><mo></mo></msubsup><mo>=</mo><mn>1</mn><mo>,</mo><mn>1.5</mn><mo>,</mo><mo></mo><mo>,</mo><mn>20</mn></math></span></span><script type="math/tex" id="MathJax-Element-38">\Lambda^*_i =
1, 1.5, \dots, 20</script></span>. Any other vector will return the
misclassified points for various threshold values specified. We set
<code>Lambda_i = 0</code> and then we plot the number of misclassified
observations for each <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-565" style="width: 1.372em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1001.13em, 2.622em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-566"><span class="msubsup" id="MathJax-Span-567"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-568" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.455em, 1000.42em, 4.17em, -999.997em); top: -4.283em; left: 0.717em;"><span class="mo" id="MathJax-Span-569" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.3em, 4.17em, -999.997em); top: -3.688em; left: 0.717em;"><span class="mi" id="MathJax-Span-570" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi mathvariant="normal"></mi><mi>i</mi><mo></mo></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-39">\Lambda^*_i</script></span>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb13-1" tabindex="-1"></a>kde_classifications <span class="ot">&lt;-</span> <span class="fu">kde_classif</span>(<span class="at">data =</span> dt,</span>
<span id="cb13-2"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb13-2" tabindex="-1"></a>                                   <span class="at">target_inx =</span> <span class="dv">1</span>,</span>
<span id="cb13-3"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb13-3" tabindex="-1"></a>                                   <span class="at">pred_inx =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">7</span>),</span>
<span id="cb13-4"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb13-4" tabindex="-1"></a>                                   <span class="at">marg_outs =</span> <span class="fu">unique</span>(<span class="fu">unlist</span>(marginal_outliers)),</span>
<span id="cb13-5"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb13-5" tabindex="-1"></a>                                   <span class="at">Lambda_i =</span> <span class="dv">0</span>,</span>
<span id="cb13-6"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb13-6" tabindex="-1"></a>                                   <span class="at">kernel =</span> <span class="st">"gauss"</span>,</span>
<span id="cb13-7"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb13-7" tabindex="-1"></a>                                   <span class="at">alpha_val =</span> <span class="fl">0.3</span>)</span>
<span id="cb13-8"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb13-8" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">20</span>, <span class="at">by =</span>.<span class="dv">5</span>), <span class="at">y =</span> kde_classifications[[<span class="dv">1</span>]],</span>
<span id="cb13-9"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb13-9" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">'l'</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">'navy'</span>,</span>
<span id="cb13-10"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb13-10" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(Lambda[i]<span class="sc">~</span><span class="st">"*"</span>),</span>
<span id="cb13-11"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb13-11" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Misclassified Observations"</span>,</span>
<span id="cb13-12"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb13-12" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Misclassified observations for varying threshold values"</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA6lBMVEUAAAAAAA0AADoAAGYAAIAADQAADVEAOjoAOmYAOpAAWIEAWLYAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kJA6kLY6kNtJAABRvP9mAABmADpmOgBmOjpmZmZmZrZmkLZmkNtmtttmtv+QKgCQOgCQZgCQZjqQkDqQkGaQkLaQtpCQttuQtv+Q29uQ2/+dOgC2ZgC2Zjq2Zma2ZpC2kDq2kGa227a229u22/+2/9u2//+8///bkDrbkGbbtmbbtpDb25Db27bb29vb2//b////tmb/25D/27b//7b//9v////pgENsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAL1klEQVR4nO2dDXvktBHHTZJC0tbbXrkC225DKRcOSksbfJSWNLiUl3iz6+//ddBoJFv22hrZlr1a7fyfB26zlmbkn/Uya8lyUrKsSo5dgNDFgAgxIEIMiBADIsSACDEgQgyIEAMixIAIMSBCDIgQAyLEgAgxIEIMiBADIsSACDEgQgyIEAMixIAIMSBCDIgQAyLEgAgxIEIMiBADIsSACDEgQgyIUPI6uXnq+D5LLh9dvx2g/b8ey32Py54cb1ZJ8t4kp9KMg1MoXJknF/fml8sCer69HAqoSITWU5xKOTiVhTsE1JN6HkAj8rcLPJ+wcD01aP8mSS7ek4ihTl9/YZ7K/z9Mknf+8oQ2/iP++P0DfP2/FyIPfqyzC/t/v00ubzG7uPx3Iv+tqATv3kN2ocv/qotZmxWZ/iksXN+3zJYqCxS5kRpcPNQn1fajklyskrRUR7EGNRzt5afqRLFwj2YSMIOAdhs4mlw/yrqIqgDl+DecVGYcy+uPRnb89uY7WWKRXuQqMKE4ywYgw6z6KEEYZk1AB6mxwRSdfnSSr9EMMNCA6jR4ohcvDgC1TlFmzOCCbFfQ1oWb9Ang6iKKr9H0Whq5eSjF2acAJX2Cj/LrKnsuU/wovKcS3BoK8usndVReLiyraVb8//oBP5tm1eWBs2mlBhfyaI8flUT8cSePpmUFSDtSJ5qZ10JBuXkwPElA0gH8LVJkuk408+E/GTZQ+CycX3+DKczsOV5S/Ydqzz/8+wVANQGZZjHTFlqEYdYEdJi6OtzlRyVBfLKWVYC0o74TxSR4SvBZAhI5UG8lyS+w3VZNU3f/ObYR+S18xhoqe4Uqu2wKWFa4eCrr/jM82gDUMIuZ9JXWZg1AHanLqn53+NFJ1CUXR6s+6L5Rpcxxw+ykZRL5WQJSrVfoV7s/tABhUnUdMqOcz7cI5R9lld0oPVw8rO5wytd/+2HTBNQwaxaqNmsA6kit1O3HvExYGQ4AaZNOgNDOnfB/t/+kBbavBol/nj9/IXtLbOpmi8CL91fdfay1R7oGGWadalC3H/My5bpLnlCD4E8AlIkUX9r7IDVo6IP7T8VHfWYNQLLdQREK3e7Xlj7IBKTNmgYPU2t1+jEukximZPtrA+rvgzoAQef7KvvlJnn7Wxixm517axS7VKOYKM8HT9AgVPbyeVMXAf0hTZn/+XXdN3SNYlWhTLMGoMPUlXr9VPjWZRegg1EsVxFCFyAVyLz1x/3r1Ix1VMbOOOhNHVKo7LV9UKFMVIEVFqo7DqoLZZg1q+RB6kpdfqok8KU+2gLUjoOwcI/dgMrnz1Y6QN5/vUreeXUQSX+samEdSX8HXcW78mOdvS591WJgdLn+Qg4oMnj9xoykP64hqAyGWQPQQepKXX4alyktOwHJwrx8MLoLKNzDAaAybhVm0NSljPgRWwPSVXTiDY2w9Hzbez6ZvIuyXdUDTKdqQFlUZKRk39h3q0RHb8TNggrQbjP9pktoEoAuPug9+vzhyrxv0CMDkL2tnqsqQGKAP2IxwlXdBxVEd3+mMppYO0BkgWKPgyaLAREyAMkfdktNIZyMzE4a75tyV92QMcxjoJgPmNQ7Bx0EigWPYg1xDSLEfRAhHsUIcRxEiAERYkCEENBus+Yfq93iGkSoDhT/hOMXB4pNHQDKGVBDCpCeMrXMApypDmoQqynupAnVgPQ4z31QQ8bM6s1TDmsE+cdqQ42Z1QIWQPDtjoYaN8y2v32U/7FqNW6YwUg2DVByMhoMSEaI2XpiEzuZQXEEoDJLzSWNM/s9tsYAWtTvsXVUQFdXfo3OoeGAdpvUm98TIDSiBsHv1cm37GMGVKple+l0v9ECKiEcGjOMtcKLaAFxDbIklMukuQ/qT8ijGJFQL17w4TdKQH7WSStz4RMa0Ul7me+JGJCfmdWIAXn1y4AIc3EC2sFDp5l1LCOfKYsZUHFxn8MD0BZCuZ52LfrmXyMGBHEQ3G61zM0boVLfjdmIAUEcBKdtGe2NUKkvlTYXPKHxNSjrv2nvXoNiBKT6IOsy4Oog1QdFCQhDRfvveR1N9tayqAH59MuAWlbaE5YxAoIIKLe0Hv3keOEQKEYJKIONgFKYX+2TBCTHr957IxEDUhss2eOgtUZzhsO83mDJEkkDILXAigoUgyc0pomluw38Fkt70w6oQTECgo0u7q37L2AUlJaWjT5iBuQkSbE/kGZAzuZiBCRb0MQlnDEDws1N8mmTqxED0vcyLLc7hpiLD5Cf5+Zrv4ETGlODUvmvr1Wu0QFSY3fhqQ+KDFA1reppZrWMDdAMfhkQYS46QDhpOrKH7ngEIjZAatI0n/jIarSAqsFr4gN1sQIy7nJ4iqRDJzR4mCcnlQf7ZUCE36gAcROjEvrvpCMD5H+Yjw3QtECxy29sgJzkukYRdI6AnNcoSgVNaBZAA1aYgc4P0IA1iqDzA8Q1iJL7GkVQTIBcb7k6r1EExQQI5PmmfXSAJk37dG6qEhkg94nDwrJYOGJATlPPWZKsty+f6DWKUiETmmfxAsDL8IVxDsN8bIDo5S+y3mx/A4BcAsXoAJHChXf7n8ozrUG0qhWw9BpFUGyAHB7JVD1U/4ukYgbk8EjmQL9xAXJ4JHOo37gAOTySOdhvwITG1yBv0z5lZIBcHskc6jcuQC6PZA70Gxkg/34ZEGGOARHm4gHk7c0ssQKa7K57m+Z4AIko0c9rI1p+wyU0ookxIFvC3PtKe6l4APl6M0vbb7CEwhjmGRBpLhZAM8VBZbiEQqlBDIgyFxEgenucYWsUlQIlNAIQvT3OwDWKqGgAOWyPM3CFGSoqQOT2OIPWKKKuwiQ0pomR2+OMqkGBVqFRnTS1Pc7ANYpaQRKaaZgftEZR65wAjTMXIqGZ4qBeK9YXv0UCyCEOGuv3SmqKXe+aJQ4a7fcqPEIzxUHkfUeL31MH5BAHObw6yuY3KELzxEElcZgCFBChuYb5/sV3DubOAdA0cwERGtfEZrjl2tBVEHIoaOcZeXlbOOH32GykXAracUZ+3hbuucXOp3Fx0PS3hUcMyNPbwifkXVQj+iB+WziV0Mvbwk9GIwAtKHev/k9k4BkzIL/JPenkAHnbqnSQV68puQYtnnBUck86TUDwnE//+w686iQB4XNQft6J7e7VW8rZAfnZsn2oV38pZwekJ96nPZIZn4zfYvJu6na1SCd0OjIq3HaVTH6gLj6dzM/vY4kBEfKzeCFieV68EJ88L16IT0MWL5ylBi1eOEcNW7xwhuJhnhADIrQ8oPplpITUFKZt20YzIWVXPoizdrNoSN+T9vRAnYNwGz1au40sCeydat8/VSUk7O5fCyM5AKQtmlq+BjkGWgVeKrwLY4teVULKLi5bEUEMbbGh5QHlqUuqIlnLM67Oi0roZlfUHNJiUwhIPyi3RBPLfqf7AkIIyLqvpZHQza4IhV0sGlI1aLdZ6kYQRKNlad+NECXPATsLe5chEzrZhTkJF4uGjFuuy0xooFwu4DBALnYL3UePAVTCXr+L/Q5zWek3sInRdnFOa1wTU8qTaXu8OctlrHfrpMsmIItd9cTtqE661nY1cy3C8jk3MZdB2SBpsaufBpwyzMNgNnsrk0Vz7qRdwjo1itnt1tM1owNFEXEt0sAyRz+qNuTkDwOV0G5XbQAEpmiLhipAmdPvo/OTApQvN4CdmJaPpE9MfD+IEAMixIAIMSBCDIgQAyLEgAgxIEIMiBADIsSACDEgQgyIEAMixIAIMSBCDIgQAyLEgAgxIEInBMhtYZFvhQyoMY9cXHz+/jHWcIcMKGtMlNJb8M2igAHt/nybGn8WN5+mPSnnVMCAirvGGpXsbtrWRiMVMKCvHiduqOZF4QLafUTva7mAwgVU3AXxjHq4gL7Sy8a2L4/5lGiwgEQLc9g7dn6FCmifyf45T15xDeoSLFi6w1WBN98zILu4BhFiQIQYECEGFLQYECEGRIgBEWJAhBgQIQZEiAERYkCEGBAhBkSIARFiQIQYECEGRIgBEWJAhBgQIQZEiAERYkCEGBAhBkSIARH6GakpSW+zaMYMAAAAAElFTkSuQmCC"><!-- --></p>
<p>The plot above reveals that a suitable <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-571" style="width: 1.372em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1001.13em, 2.622em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-572"><span class="msubsup" id="MathJax-Span-573"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-574" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.455em, 1000.42em, 4.17em, -999.997em); top: -4.283em; left: 0.717em;"><span class="mo" id="MathJax-Span-575" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.3em, 4.17em, -999.997em); top: -3.688em; left: 0.717em;"><span class="mi" id="MathJax-Span-576" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi mathvariant="normal"></mi><mi>i</mi><mo></mo></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-40">\Lambda^*_i</script></span> value should be somewhere
around 5. We have introduced the Method of Consecutive Angles, which is
capable of determining a <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-577" style="width: 1.372em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1001.13em, 2.622em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-578"><span class="msubsup" id="MathJax-Span-579"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-580" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.455em, 1000.42em, 4.17em, -999.997em); top: -4.283em; left: 0.717em;"><span class="mo" id="MathJax-Span-581" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.3em, 4.17em, -999.997em); top: -3.688em; left: 0.717em;"><span class="mi" id="MathJax-Span-582" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi mathvariant="normal"></mi><mi>i</mi><mo></mo></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-41">\Lambda^*_i</script></span> value that gives reasonable
results using the angles between consecutive line segments that join the
amount of misclassified points for consecutive <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-583" style="width: 1.372em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1001.13em, 2.622em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-584"><span class="msubsup" id="MathJax-Span-585"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-586" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.455em, 1000.42em, 4.17em, -999.997em); top: -4.283em; left: 0.717em;"><span class="mo" id="MathJax-Span-587" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.3em, 4.17em, -999.997em); top: -3.688em; left: 0.717em;"><span class="mi" id="MathJax-Span-588" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi mathvariant="normal"></mi><mi>i</mi><mo></mo></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-42">\Lambda^*_i</script></span> values. This method,
implemented in the function <code>consec_angles</code>, requires a
vector of observed values, the range of values for which these
observations were made (in this case that is the sequence of values from
1 up to 20 in steps of half a unit) and 2 tolerance parameters. The
first one, <code>drop_tol</code>, accounts for the fact that the rate of
decrease of the misclassified observations for 2 consecutive <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-589" style="width: 1.372em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1001.13em, 2.622em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-590"><span class="msubsup" id="MathJax-Span-591"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-592" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.455em, 1000.42em, 4.17em, -999.997em); top: -4.283em; left: 0.717em;"><span class="mo" id="MathJax-Span-593" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.3em, 4.17em, -999.997em); top: -3.688em; left: 0.717em;"><span class="mi" id="MathJax-Span-594" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi mathvariant="normal"></mi><mi>i</mi><mo></mo></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-43">\Lambda^*_i</script></span> values may be the same but if
the actual different (or drop) exceeds a tolerated level
<code>drop_tol</code>, it cannot be considered as insignificant. We use
the default value of <code>drop_tol = 3</code>. Then,
<code>range_tol</code> controls the maximum value of <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msubsup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-595" style="width: 4.824em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.991em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1003.99em, 2.622em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-596"><span class="mi" id="MathJax-Span-597" style="font-family: MathJax_Math-italic;">L</span><span class="mi" id="MathJax-Span-598" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-599" style="font-family: MathJax_Math-italic;">m</span><span class="mi" id="MathJax-Span-600" style="font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-601" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-602"><span style="display: inline-block; position: relative; width: 0.955em; height: 0px;"><span style="position: absolute; clip: rect(3.396em, 1000.54em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-603" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.455em, 1000.42em, 4.17em, -999.997em); top: -4.283em; left: 0.539em;"><span class="mo" id="MathJax-Span-604" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.3em, 4.17em, -999.997em); top: -3.688em; left: 0.539em;"><span class="mi" id="MathJax-Span-605" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi><mi>a</mi><mi>m</mi><mi>b</mi><mi>d</mi><msubsup><mi>a</mi><mi>i</mi><mo></mo></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-44">Lambda^*_i</script></span> for which we want to use the
method of consecutive angles. Here, we take the default
<code>range_tol = 21</code> which corresponds to the 21st element of the
sequence 1, 1.5, <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-606" style="width: 1.432em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.908em, 1001.13em, 2.384em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-607"><span class="mo" id="MathJax-Span-608" style="font-family: MathJax_Main;"></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo></mo></math></span></span><script type="math/tex" id="MathJax-Element-45">\dots</script></span>, 20. This is
the value <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;11&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-609" style="width: 4.229em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.515em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1003.46em, 2.682em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-610"><span class="msubsup" id="MathJax-Span-611"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-612" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.455em, 1000.42em, 4.17em, -999.997em); top: -4.283em; left: 0.717em;"><span class="mo" id="MathJax-Span-613" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.3em, 4.17em, -999.997em); top: -3.688em; left: 0.717em;"><span class="mi" id="MathJax-Span-614" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-615" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="mn" id="MathJax-Span-616" style="font-family: MathJax_Main; padding-left: 0.301em;">11</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi mathvariant="normal"></mi><mi>i</mi><mo></mo></msubsup><mo>=</mo><mn>11</mn></math></span></span><script type="math/tex" id="MathJax-Element-46">\Lambda^*_i = 11</script></span>, meaning
that if the method of consecutive angles finds a <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-617" style="width: 1.372em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1001.13em, 2.622em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-618"><span class="msubsup" id="MathJax-Span-619"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-620" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.455em, 1000.42em, 4.17em, -999.997em); top: -4.283em; left: 0.717em;"><span class="mo" id="MathJax-Span-621" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.3em, 4.17em, -999.997em); top: -3.688em; left: 0.717em;"><span class="mi" id="MathJax-Span-622" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi mathvariant="normal"></mi><mi>i</mi><mo></mo></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-47">\Lambda^*_i</script></span> value over 11, it will return
the elbow point of the curve instead, using the <code>kneedle</code>
algorithm. We calculate <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-623" style="width: 1.372em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1001.13em, 2.622em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-624"><span class="msubsup" id="MathJax-Span-625"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-626" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.455em, 1000.42em, 4.17em, -999.997em); top: -4.283em; left: 0.717em;"><span class="mo" id="MathJax-Span-627" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.3em, 4.17em, -999.997em); top: -3.688em; left: 0.717em;"><span class="mi" id="MathJax-Span-628" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi mathvariant="normal"></mi><mi>i</mi><mo></mo></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-48">\Lambda_i^*</script></span>
for our data set below. We also output the indices for the observations
with a KDE ratio over the <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-629" style="width: 1.372em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1001.13em, 2.622em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-630"><span class="msubsup" id="MathJax-Span-631"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-632" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.455em, 1000.42em, 4.17em, -999.997em); top: -4.283em; left: 0.717em;"><span class="mo" id="MathJax-Span-633" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.3em, 4.17em, -999.997em); top: -3.688em; left: 0.717em;"><span class="mi" id="MathJax-Span-634" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi mathvariant="normal"></mi><mi>i</mi><mo></mo></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-49">\Lambda^*_i</script></span> value returned.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb14-1" tabindex="-1"></a>Lambda_star <span class="ot">&lt;-</span> <span class="fu">consec_angles</span>(<span class="at">vec =</span> kde_classifications[[<span class="dv">1</span>]],</span>
<span id="cb14-2"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb14-2" tabindex="-1"></a>                             <span class="at">range =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">20</span>, <span class="at">by =</span> .<span class="dv">5</span>),</span>
<span id="cb14-3"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb14-3" tabindex="-1"></a>                             <span class="at">drop_tol =</span> <span class="dv">3</span>,</span>
<span id="cb14-4"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb14-4" tabindex="-1"></a>                             <span class="at">range_tol =</span> <span class="dv">21</span>)</span>
<span id="cb14-5"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb14-5" tabindex="-1"></a><span class="fu">print</span>(Lambda_star)</span>
<span id="cb14-6"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb14-6" tabindex="-1"></a><span class="co">#&gt; [1] 4.5</span></span>
<span id="cb14-7"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb14-7" tabindex="-1"></a></span>
<span id="cb14-8"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb14-8" tabindex="-1"></a><span class="co"># Use Lambda_star</span></span>
<span id="cb14-9"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb14-9" tabindex="-1"></a>Lambda_star_inx <span class="ot">&lt;-</span> <span class="fu">match</span>(Lambda_star, <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">20</span>, <span class="at">by =</span> .<span class="dv">5</span>))</span>
<span id="cb14-10"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb14-10" tabindex="-1"></a><span class="co"># Joint outliers detected</span></span>
<span id="cb14-11"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb14-11" tabindex="-1"></a>joint_outs_det <span class="ot">&lt;-</span> kde_classifications[[<span class="dv">2</span>]][[Lambda_star_inx]]</span>
<span id="cb14-12"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb14-12" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">length</span>(joint_outs_det))</span>
<span id="cb14-13"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb14-13" tabindex="-1"></a><span class="co">#&gt; [1] 5</span></span>
<span id="cb14-14"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb14-14" tabindex="-1"></a><span class="fu">summary</span>(dt[joint_outs_det, ])</span>
<span id="cb14-15"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb14-15" tabindex="-1"></a><span class="co">#&gt;  V1    V2    V3    V4    V5          V6                V7         </span></span>
<span id="cb14-16"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb14-16" tabindex="-1"></a><span class="co">#&gt;  1:3   1:2   1:0   1:1   1:1   Min.   :-2.6463   Min.   :-3.0201  </span></span>
<span id="cb14-17"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb14-17" tabindex="-1"></a><span class="co">#&gt;  2:1   2:0   2:4   2:3   2:3   1st Qu.: 0.2304   1st Qu.:-0.8677  </span></span>
<span id="cb14-18"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb14-18" tabindex="-1"></a><span class="co">#&gt;  3:1   3:3   3:1   3:1   3:1   Median : 1.3857   Median : 0.2847  </span></span>
<span id="cb14-19"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb14-19" tabindex="-1"></a><span class="co">#&gt;  4:0   4:0   4:0   4:0   4:0   Mean   : 0.4664   Mean   : 0.2666  </span></span>
<span id="cb14-20"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb14-20" tabindex="-1"></a><span class="co">#&gt;        5:0                     3rd Qu.: 1.5706   3rd Qu.: 2.3174  </span></span>
<span id="cb14-21"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb14-21" tabindex="-1"></a><span class="co">#&gt;                                Max.   : 1.7915   Max.   : 2.6189  </span></span>
<span id="cb14-22"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb14-22" tabindex="-1"></a><span class="co">#&gt;        V8                V9                V10              V11   </span></span>
<span id="cb14-23"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb14-23" tabindex="-1"></a><span class="co">#&gt;  Min.   :-0.4661   Min.   :-2.06609   Min.   :-1.406   Min.   :3  </span></span>
<span id="cb14-24"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb14-24" tabindex="-1"></a><span class="co">#&gt;  1st Qu.: 0.5264   1st Qu.:-0.79379   1st Qu.: 1.107   1st Qu.:3  </span></span>
<span id="cb14-25"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb14-25" tabindex="-1"></a><span class="co">#&gt;  Median : 0.6659   Median :-0.66933   Median : 1.507   Median :3  </span></span>
<span id="cb14-26"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb14-26" tabindex="-1"></a><span class="co">#&gt;  Mean   : 0.6846   Mean   :-0.78264   Mean   : 1.194   Mean   :3  </span></span>
<span id="cb14-27"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb14-27" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.: 0.7462   3rd Qu.:-0.44406   3rd Qu.: 2.002   3rd Qu.:3  </span></span>
<span id="cb14-28"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb14-28" tabindex="-1"></a><span class="co">#&gt;  Max.   : 1.9508   Max.   : 0.06005   Max.   : 2.758   Max.   :3</span></span></code></pre></div>
<p>Indeed we can see above that just a few observations remained by
demanding that the KDE ratio exceeds the <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-635" style="width: 1.372em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1001.13em, 2.622em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-636"><span class="msubsup" id="MathJax-Span-637"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-638" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.455em, 1000.42em, 4.17em, -999.997em); top: -4.283em; left: 0.717em;"><span class="mo" id="MathJax-Span-639" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.3em, 4.17em, -999.997em); top: -3.688em; left: 0.717em;"><span class="mi" id="MathJax-Span-640" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi mathvariant="normal"></mi><mi>i</mi><mo></mo></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-50">\Lambda^*_i</script></span> value found by the method of
consecutive angles and all these are joint outliers. However, the method
of consecutive angles is not always ideal; in fact, it turns out that in
some instances it may be better to sacrifice some inliers just for the
sake of not missing many joint outliers. In any case, we provide the
user with the <code>elbow_angle</code> function, which returns the value
of the angle (in degrees) between the line segments joining the number
of misclassified observations for <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-641" style="width: 3.693em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.039em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1002.98em, 2.682em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-642"><span class="msubsup" id="MathJax-Span-643"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-644" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.455em, 1000.42em, 4.17em, -999.997em); top: -4.283em; left: 0.717em;"><span class="mo" id="MathJax-Span-645" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.3em, 4.17em, -999.997em); top: -3.688em; left: 0.717em;"><span class="mi" id="MathJax-Span-646" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-647" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="mn" id="MathJax-Span-648" style="font-family: MathJax_Main; padding-left: 0.301em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi mathvariant="normal"></mi><mi>i</mi><mo></mo></msubsup><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-51">\Lambda_i^* = 1</script></span> and <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;b&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;o&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-649" style="width: 6.074em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.063em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1005.06em, 2.682em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-650"><span class="msubsup" id="MathJax-Span-651"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-652" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.455em, 1000.42em, 4.17em, -999.997em); top: -4.283em; left: 0.717em;"><span class="mo" id="MathJax-Span-653" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.3em, 4.17em, -999.997em); top: -3.688em; left: 0.717em;"><span class="mi" id="MathJax-Span-654" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-655" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="msubsup" id="MathJax-Span-656" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 2.562em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-657" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.717em;"><span class="texatom" id="MathJax-Span-658"><span class="mrow" id="MathJax-Span-659"><span class="mi" id="MathJax-Span-660" style="font-size: 70.7%; font-family: MathJax_Main;">e</span><span class="mi" id="MathJax-Span-661" style="font-size: 70.7%; font-family: MathJax_Main;">l</span><span class="mi" id="MathJax-Span-662" style="font-size: 70.7%; font-family: MathJax_Main;">b</span><span class="mi" id="MathJax-Span-663" style="font-size: 70.7%; font-family: MathJax_Main;">o</span><span class="mi" id="MathJax-Span-664" style="font-size: 70.7%; font-family: MathJax_Main;">w</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi mathvariant="normal"></mi><mi>i</mi><mo></mo></msubsup><mo>=</mo><msub><mi mathvariant="normal"></mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">w</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-52">\Lambda_i^* = \Lambda_\mathrm{elbow}</script></span> and
for <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;b&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;o&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-665" style="width: 6.074em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.063em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1005.06em, 2.682em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-666"><span class="msubsup" id="MathJax-Span-667"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-668" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.455em, 1000.42em, 4.17em, -999.997em); top: -4.283em; left: 0.717em;"><span class="mo" id="MathJax-Span-669" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.3em, 4.17em, -999.997em); top: -3.688em; left: 0.717em;"><span class="mi" id="MathJax-Span-670" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-671" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="msubsup" id="MathJax-Span-672" style="padding-left: 0.301em;"><span style="display: inline-block; position: relative; width: 2.562em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-673" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.717em;"><span class="texatom" id="MathJax-Span-674"><span class="mrow" id="MathJax-Span-675"><span class="mi" id="MathJax-Span-676" style="font-size: 70.7%; font-family: MathJax_Main;">e</span><span class="mi" id="MathJax-Span-677" style="font-size: 70.7%; font-family: MathJax_Main;">l</span><span class="mi" id="MathJax-Span-678" style="font-size: 70.7%; font-family: MathJax_Main;">b</span><span class="mi" id="MathJax-Span-679" style="font-size: 70.7%; font-family: MathJax_Main;">o</span><span class="mi" id="MathJax-Span-680" style="font-size: 70.7%; font-family: MathJax_Main;">w</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi mathvariant="normal"></mi><mi>i</mi><mo></mo></msubsup><mo>=</mo><msub><mi mathvariant="normal"></mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">w</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-53">\Lambda_i^* =
\Lambda_\mathrm{elbow}</script></span> and <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;20&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-681" style="width: 4.229em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.515em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1003.46em, 2.682em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-682"><span class="msubsup" id="MathJax-Span-683"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-684" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.455em, 1000.42em, 4.17em, -999.997em); top: -4.283em; left: 0.717em;"><span class="mo" id="MathJax-Span-685" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.3em, 4.17em, -999.997em); top: -3.688em; left: 0.717em;"><span class="mi" id="MathJax-Span-686" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-687" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="mn" id="MathJax-Span-688" style="font-family: MathJax_Main; padding-left: 0.301em;">20</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi mathvariant="normal"></mi><mi>i</mi><mo></mo></msubsup><mo>=</mo><mn>20</mn></math></span></span><script type="math/tex" id="MathJax-Element-54">\Lambda_i^* = 20</script></span>. Notice that <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-55-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;b&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;o&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-689" style="width: 3.098em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.562em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1002.56em, 2.503em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-690"><span class="msubsup" id="MathJax-Span-691"><span style="display: inline-block; position: relative; width: 2.562em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-692" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.717em;"><span class="texatom" id="MathJax-Span-693"><span class="mrow" id="MathJax-Span-694"><span class="mi" id="MathJax-Span-695" style="font-size: 70.7%; font-family: MathJax_Main;">e</span><span class="mi" id="MathJax-Span-696" style="font-size: 70.7%; font-family: MathJax_Main;">l</span><span class="mi" id="MathJax-Span-697" style="font-size: 70.7%; font-family: MathJax_Main;">b</span><span class="mi" id="MathJax-Span-698" style="font-size: 70.7%; font-family: MathJax_Main;">o</span><span class="mi" id="MathJax-Span-699" style="font-size: 70.7%; font-family: MathJax_Main;">w</span></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal"></mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">e</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">b</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">w</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-55">\Lambda_\mathrm{elbow}</script></span> is the value of
<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-700" style="width: 1.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1001.01em, 2.503em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-701"><span class="msubsup" id="MathJax-Span-702"><span style="display: inline-block; position: relative; width: 1.015em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-703" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.717em;"><span class="mi" id="MathJax-Span-704" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal"></mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-56">\Lambda_i</script></span> for which an elbow in the
curve of misclassified points is being observed. This value turns out to
be very useful for determining the method to be used, with the number of
discrete levels of the target discrete feature being of crucial
importance. If the number of levels is larger than 5 for instance, the
method of consecutive angles is the best option but for a smaller number
of levels, going for <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-57-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-705" style="width: 1.372em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1001.13em, 2.622em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-706"><span class="msubsup" id="MathJax-Span-707"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-708" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.455em, 1000.42em, 4.17em, -999.997em); top: -4.283em; left: 0.717em;"><span class="mo" id="MathJax-Span-709" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.3em, 4.17em, -999.997em); top: -3.688em; left: 0.717em;"><span class="mi" id="MathJax-Span-710" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi mathvariant="normal"></mi><mi>i</mi><mo></mo></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-57">\Lambda_i^*</script></span>
equal to a small value above 1 returns better results. As an
illustration, we calculate the elbow angle for our
misclassifications.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb15-1" tabindex="-1"></a>angle <span class="ot">&lt;-</span> <span class="fu">elbow_angle</span>(<span class="at">vec =</span> kde_classifications[[<span class="dv">1</span>]],</span>
<span id="cb15-2"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb15-2" tabindex="-1"></a>                     <span class="at">range =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">20</span>, <span class="at">by =</span> .<span class="dv">5</span>))</span>
<span id="cb15-3"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb15-3" tabindex="-1"></a><span class="co">#&gt; Registered S3 method overwritten by 'quantmod':</span></span>
<span id="cb15-4"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb15-4" tabindex="-1"></a><span class="co">#&gt;   method            from</span></span>
<span id="cb15-5"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb15-5" tabindex="-1"></a><span class="co">#&gt;   as.zoo.data.frame zoo</span></span>
<span id="cb15-6"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb15-6" tabindex="-1"></a><span class="fu">print</span>(angle)</span>
<span id="cb15-7"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb15-7" tabindex="-1"></a><span class="co">#&gt; [1] 156.6398</span></span></code></pre></div>
<p>Now, we are ready to detect the joint outliers in our data set. The
function <code>joint_outs</code> can detect the joint outliers for given
associations between discrete and continuous features. The parameter
<code>assoc_target</code> takes as input a vector of target discrete
variables, which have been found to be associated with sets of
continuous variables. Then, <code>assoc_vars</code> will be a list
including the corresponding vectors of the continuous features
associated with each target discrete variable that was earlier defined
in <code>assoc_target</code>. The <code>method</code> argument can take
3 levels; <code>"consec_angles"</code>, <code>"conservative"</code> or
<code>"bin"</code>. The first option will choose a suitable value for
the threshold parameter <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-711" style="width: 1.372em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1001.13em, 2.622em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-712"><span class="msubsup" id="MathJax-Span-713"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-714" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.455em, 1000.42em, 4.17em, -999.997em); top: -4.283em; left: 0.717em;"><span class="mo" id="MathJax-Span-715" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.3em, 4.17em, -999.997em); top: -3.688em; left: 0.717em;"><span class="mi" id="MathJax-Span-716" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi mathvariant="normal"></mi><mi>i</mi><mo></mo></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-58">\Lambda_i^*</script></span>
using the method of consecutive angles, as described earlier. The option
<code>"conservative"</code> sets by default <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-59-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-717" style="width: 3.693em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.039em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1002.98em, 2.682em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-718"><span class="msubsup" id="MathJax-Span-719"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-720" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.455em, 1000.42em, 4.17em, -999.997em); top: -4.283em; left: 0.717em;"><span class="mo" id="MathJax-Span-721" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.3em, 4.17em, -999.997em); top: -3.688em; left: 0.717em;"><span class="mi" id="MathJax-Span-722" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-723" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="mn" id="MathJax-Span-724" style="font-family: MathJax_Main; padding-left: 0.301em;">3</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi mathvariant="normal"></mi><mi>i</mi><mo></mo></msubsup><mo>=</mo><mn>3</mn></math></span></span><script type="math/tex" id="MathJax-Element-59">\Lambda^*_i = 3</script></span>, which is a rather
conservative choice that is found to perform well in some cases and
finally <code>method = "bin"</code> refers to the case of a binary
target variable, where <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-60-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-725" style="width: 3.693em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.039em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.313em, 1002.98em, 2.682em, -999.997em); top: -2.199em; left: 0em;"><span class="mrow" id="MathJax-Span-726"><span class="msubsup" id="MathJax-Span-727"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-728" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.455em, 1000.42em, 4.17em, -999.997em); top: -4.283em; left: 0.717em;"><span class="mo" id="MathJax-Span-729" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.3em, 4.17em, -999.997em); top: -3.688em; left: 0.717em;"><span class="mi" id="MathJax-Span-730" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span><span class="mo" id="MathJax-Span-731" style="font-family: MathJax_Main; padding-left: 0.301em;">=</span><span class="mn" id="MathJax-Span-732" style="font-family: MathJax_Main; padding-left: 0.301em;">2</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi mathvariant="normal"></mi><mi>i</mi><mo></mo></msubsup><mo>=</mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-60">\Lambda^*_i =
2</script></span> is chosen instead, due to poor performance that has been
empirically observed for higher threshold values. The parameters
<code>drop_tol</code> and <code>range_tol</code> can also be specified
by the user. The <code>joint_outs</code> function will essentially make
use of <code>kde_classif</code> with the default hyperparameter choices
for <code>kernel</code> and <code>alpha_val</code>. If
<code>method</code> is set equal to <code>"consec_angles"</code>, the
parameter <code>Lambda_i</code> will also be set to its default of 0,
otherwise for <code>method = "conservative"</code> or for
<code>method = "bin"</code>, <code>Lambda_i</code> will be set equal to
3 or 2, respectively. Them <code>drop_tol</code> and
<code>range_tol</code> can be specified by the user. The output of
<code>kde_classif</code> will be returned if
<code>method = "conservative"</code> or if <code>method = "bin"</code>,
while for <code>method = "consec_angles"</code>, the
<code>consec_angles</code> function will be used to determine what a
suitable <span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-61-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x039B;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2217;&lt;/mo&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-733" style="width: 1.372em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1001.13em, 2.622em, -999.997em); top: -2.14em; left: 0em;"><span class="mrow" id="MathJax-Span-734"><span class="msubsup" id="MathJax-Span-735"><span style="display: inline-block; position: relative; width: 1.134em; height: 0px;"><span style="position: absolute; clip: rect(3.098em, 1000.66em, 4.17em, -999.997em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-736" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.455em, 1000.42em, 4.17em, -999.997em); top: -4.283em; left: 0.717em;"><span class="mo" id="MathJax-Span-737" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; clip: rect(3.336em, 1000.3em, 4.17em, -999.997em); top: -3.688em; left: 0.717em;"><span class="mi" id="MathJax-Span-738" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.146em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi mathvariant="normal"></mi><mi>i</mi><mo></mo></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-61">\Lambda^*_i</script></span> value should
be and the output corresponding to this value will be given to the user.
However, if the user wishes to select their preferred
<code>method</code> for each association according to the value of the
elbow angle, this process needs to be done manually and the
<code>elbow_angle</code> function should be used as well. In order to
wrap things up, we finally detect the joint outliers based on the
associations we found between the first and the second discrete features
with the first 2 continuous variables. The results reveal that all joint
outliers were detected, alongside a very small number of inliers which
were falsely flagged to be joint outliers.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb16-1" tabindex="-1"></a>joint_outliers <span class="ot">&lt;-</span> <span class="fu">joint_outs</span>(<span class="at">data =</span> dt,</span>
<span id="cb16-2"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb16-2" tabindex="-1"></a>                             <span class="at">marg_outs =</span> <span class="fu">unique</span>(<span class="fu">unlist</span>(marginal_outliers)),</span>
<span id="cb16-3"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb16-3" tabindex="-1"></a>                             <span class="at">assoc_target =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb16-4"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb16-4" tabindex="-1"></a>                             <span class="at">assoc_vars =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">7</span>), <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">7</span>)),</span>
<span id="cb16-5"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb16-5" tabindex="-1"></a>                             <span class="at">method =</span> <span class="st">"consec_angles"</span>,</span>
<span id="cb16-6"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb16-6" tabindex="-1"></a>                             <span class="at">drop_tol =</span> <span class="dv">3</span>,</span>
<span id="cb16-7"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb16-7" tabindex="-1"></a>                             <span class="at">range_tol =</span> <span class="dv">21</span>)</span>
<span id="cb16-8"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb16-8" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">length</span>(joint_outliers))</span>
<span id="cb16-9"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb16-9" tabindex="-1"></a><span class="co">#&gt; [1] 13</span></span>
<span id="cb16-10"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb16-10" tabindex="-1"></a><span class="fu">table</span>(dt[joint_outliers, <span class="dv">11</span>])</span>
<span id="cb16-11"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb16-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-12"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb16-12" tabindex="-1"></a><span class="co">#&gt;  0  3 </span></span>
<span id="cb16-13"><a href="file:///C:/Users/ec1917/AppData/Local/Temp/RtmpWYSSER/preview-e5c5cda7a3a.dir/Intro_to_DOMID.html#cb16-13" tabindex="-1"></a><span class="co">#&gt;  3 10</span></span></code></pre></div>
</div>
<div id="summary" class="section level2">
<h2>Summary</h2>
<p>We have introduced the <code>DOMID</code> (Detecting Outliers in
MIxed-type Data) R package and have shown how it can be used for finding
outlying observations in a data set consisting of mixed-type data
(i.e.&nbsp;continuous and discrete features). We have used an artificially
generated data set as an example on which the main functions were
applied. The main functions included in the package are described here
but we encourage the user to read the documentation should anything be
unclear.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>



<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Size4, sans-serif;"></div></div></body></html>